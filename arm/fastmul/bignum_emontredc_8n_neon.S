// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
// SPDX-License-Identifier: Apache-2.0 OR ISC

// ----------------------------------------------------------------------------
// Extend Montgomery reduce in 8-digit blocks, results in input-output buffer
// Inputs z[2*k], m[k], w; outputs function return (extra result bit) and z[2*k]
//
//    extern uint64_t bignum_emontredc_8n_neon
//     (uint64_t k, uint64_t *z, uint64_t *m, uint64_t w);
//
// Functionally equivalent to bignum_emontredc (see that file for more detail).
// But in general assumes that the input k is a multiple of 8.
//
// Standard ARM ABI: X0 = k, X1 = z, X2 = m, X3 = w, returns X0
// ----------------------------------------------------------------------------
#include "_internal_s2n_bignum.h"

					S2N_BN_SYM_VISIBILITY_DIRECTIVE(bignum_emontredc_8n_neon)
					S2N_BN_SYM_PRIVACY_DIRECTIVE(bignum_emontredc_8n_neon)
					.text
					.balign 4
.macro save_vregs // slothy:no-unfold
        sub sp, sp, #(16*4)
        stp  d8,  d9, [sp, #16*0]
        stp d10, d11, [sp, #16*1]
        stp d12, d13, [sp, #16*2]
        stp d14, d15, [sp, #16*3]
.endm

.macro restore_vregs // slothy:no-unfold
        ldp  d8,  d9, [sp, #16*0]
        ldp d10, d11, [sp, #16*1]
        ldp d12, d13, [sp, #16*2]
        ldp d14, d15, [sp, #16*3]
        add sp, sp, #(16*4)
.endm

        // Silly SLOTHY limitation: It needs the loop counter to have the name 'count'
        count .req x27 // inner loop counter

        // Semantically transparent instruction wrapper which is used by SLOTHY
        // for dependency tracking through memory. SLOTHY itself has no notion of
        // memory, only registers; to still track static dependencies through memory
        // (register spills), a 'hint' register type is introduced (syntax t{i}, t{i}{j})
        // that's written to in store instructions and read from in the corresponding
        // load instruction.
        //
        // The 'slothy:no-unfold' annotation prevents SLOTHY from opening the macro,
        // and instead makes it treat `stph` as an instruction specified in the
        // Arch and uArch models provided to it.
        .macro stph a, b, addr, imm, hint // slothy:no-unfold
            stp \a\(), \b\(), [\addr, \imm]
        .endm

        .macro ldph a, b, addr, imm, hint // slothy:no-unfold
            ldp \a\(), \b\(), [\addr, \imm]
        .endm

        .macro ldrh a, addr, imm, hint // slothy:no-unfold
            ldr \a\(), [\addr, \imm]
        .endm

        // Helper macro for the pre-computations
        .macro cdiff t, c, x, y
          subs    \t, \x, \y
          cneg    \t, \t, cc
          csetm   \c, cc
        .endm

        // Some immediate offsets for cached differences+carry used
        // in the inner ADK multiplications
        #define cache_a01 (32+0*16)
        #define cache_a02 (32+1*16)
        #define cache_a03 (32+2*16)
        #define cache_a12 (32+3*16)
        #define cache_a13 (32+4*16)
        #define cache_a23 (32+5*16)
        #define cache_m10 (0*16)
        #define cache_m20 (1*16)
        #define cache_m30 (2*16)
        #define cache_m21 (3*16)
        #define cache_m31 (4*16)
        #define cache_m32 (5*16)

        a0 .req x4
        a1 .req x5
        a2 .req x6
        a3 .req x7

        vpre00 .req v30
        vpre01 .req v28
        vpre02 .req v17
        vpre10 .req v18
        vpre11 .req v19
        vpre12 .req v20

        // Computes two 64x64->128-bit multiplication a*x and a*y
        // v_in0: 128-bit input vector viewed as pair (x,y) of 64-bit numbers
        // x_in: 64-bit common multiplicand a
        // v_out0: 128-bit output vector to hold a*x
        // v_out1: 128-bit output vector to hold a*y
        //
        // Uses temporaries as indicated in the following defines:
        #define v_in0_p   v3
        #define v_in0_pp  v5
        #define v_in0_ppp v28
        #define v_in1 v0
        #define vtmp0 v4
        #define vtmp1 v6
        #define vtmp2 v7
        #define vtmp3 v16
        #define vtmp4 v2

        .macro vmul_2x_64_64_128 v_in0, x_in, v_out0, v_out1 // slothy:no-unfold
          dup     v_in1.2d, \x_in
          uzp2    v_in0_p.4s, \v_in0\().4s, \v_in0\().4s
          xtn     vtmp0.2s, v_in1.2d
          xtn     v_in0_pp.2s, \v_in0\().2d
          rev64   v_in0_ppp.4s, \v_in0\().4s
          umull   vtmp1.2d, vtmp0.2s, v_in0_pp.2s
          umull   vtmp2.2d, vtmp0.2s, v_in0_p.2s
          uzp2    vtmp3.4s, v_in1.4s, v_in1.4s
          mul     v_in1.4s, v_in0_ppp.4s, v_in1.4s
          usra    vtmp2.2d, vtmp1.2d, #32
          umull   \v_out1\().2d, vtmp3.2s, v_in0_p.2s
          uaddlp  v_in1.2d, v_in1.4s
          and     vtmp4.16b, vtmp2.16b, v29.16b
          umlal   vtmp4.2d, vtmp3.2s, v_in0_pp.2s
          shl     \v_out0\().2d, v_in1.2d, #32
          usra    \v_out1\().2d, vtmp2.2d, #32
          umlal   \v_out0\().2d, vtmp0.2s, v_in0_pp.2s
          usra    \v_out1\().2d, vtmp4.2d, #32
        .endm

        // SLOTHY version of the above multiplication macro, using symbolic
        // registers instead of hardcoded registers. This is only used during
        // SLOTHY optimization (the above macro is ignored because of
        // 'slothy:no-unfold').
#if defined(SLOTHY)
        .macro vmul_2x_64_64_128 v_in0, x_in, v_out0, v_out1
          dup     V<in1>.2d, \x_in
          uzp2    V<in0_p>.4s, \v_in0\().4s, \v_in0\().4s
          xtn     V<tmp0>.2s, V<in1>.2d
          xtn     V<in0_pp>.2s, \v_in0\().2d
          rev64   V<in0_ppp>.4s, \v_in0\().4s
          umull   V<tmp1>.2d, V<tmp0>.2s, V<in0_pp>.2s
          umull   V<tmp2>.2d, V<tmp0>.2s, V<in0_p>.2s
          uzp2    V<tmp3>.4s, V<in1>.4s, V<in1>.4s
          mul     V<in1>.4s, V<in0_ppp>.4s, V<in1>.4s
          usra    V<tmp2>.2d, V<tmp1>.2d, #32
          umull   \v_out1\().2d, V<tmp3>.2s, V<in0_p>.2s
          uaddlp  V<in1>.2d, V<in1>.4s
          and     V<tmp4>.16b, V<tmp2>.16b, v29.16b
          umlal   V<tmp4>.2d, V<tmp3>.2s, V<in0_pp>.2s
          shl     \v_out0\().2d, V<in1>.2d, #32
          usra    \v_out1\().2d, V<tmp2>.2d, #32
          umlal   \v_out0\().2d, V<tmp0>.2s, V<in0_pp>.2s
          usra    \v_out1\().2d, V<tmp4>.2d, #32
        .endm
#endif

bignum_emontredc_8n_neon_fallback:
           b S2N_BN_SYMBOL(bignum_emontredc_8n_neon)

S2N_BN_SYMBOL(bignum_emontredc_8n_neon):

           cmp x0, #12
           ble bignum_emontredc_8n_neon_fallback

           sub sp, sp, #(6*16)
           stp x19, x20, [sp, #(5*16)]
           stp x21, x22, [sp, #(4*16)]
           stp x23, x24, [sp, #(3*16)]
           stp x25, x26, [sp, #(2*16)]
           stp x27, x28, [sp, #(1*16)]
           stp x29, x30, [sp, #(0*16)]

          save_vregs

           // Leave space for cached differences in inner loop
           sub sp, sp, #(6*16)

           sub sp, sp, #32
           lsr x0, x0, #2
           mov x26, x0
           subs x12, x0, #1
           bcc bignum_emontredc_8n_neon_end

           // x30 = buffer holding precomputed ADK carry-differences for modulus
           mov w30, #(12*8)
           mul w30, w12, w30
           sub x30, sp, x30

           //
           // Start of precomputation
           //
           // Precompute and cache signed differences of modulus components
           // used in the ADK multiplication in the inner loop.
           //
           // THIS SHOULD BE HOISTED OUT
           // (and until then, comment out for benchmarking to get accurate estimates)
           //

           // Number of extra limbs required:
           // 6 * (number of limbs / 4 - 1) * 2 = 12 * (number_of_limbs/4 - 1)
           //
           // For now, just put them on the stack
           mov sp, x30

           // Save modulus pointer
           mov x25, x2

           mov count, x12
bignum_emontredc_8n_neon_precomp:
           ldp a0, a1, [x2, #32]!
           ldp a2, a3, [x2, #16]

           t .req x28
           c .req x29

           cdiff t, c, a1, a0
           stp   t, c, [sp, #cache_m10]
           cdiff t, c, a2, a0
           stp   t, c, [sp, #cache_m20]
           cdiff t, c, a3, a0
           stp   t, c, [sp, #cache_m30]
           cdiff t, c, a2, a1
           stp   t, c, [sp, #cache_m21]
           cdiff t, c, a3, a1
           stp   t, c, [sp, #cache_m31]
           cdiff t, c, a3, a2
           stp   t, c, [sp, #cache_m32]

           add sp, sp, #(6*16)

           subs count, count, #1
           cbnz count, bignum_emontredc_8n_neon_precomp

           // Set modulus pointer back to its original value
           mov x2, x25

           //
           // End of precomputation
           //

           stp x3, x30, [sp]
           //stp x3, xzr, [sp]
           stp x26, xzr, [sp, #16]
           mov x28, xzr
           lsl x0, x12, #5

           movi    v29.2d, #0x000000ffffffff

        bignum_emontredc_8n_neon_outerloop:
        ldph x9, x13, x1, #0, t0                   // .*..................................................................................................................................................................................................................
        ldr x3, [sp]                               // *...................................................................................................................................................................................................................                                                                            // gap(s) to follow
        lsr x27, x0, #5                            // ......................................................................................................................................*.............................................................................                                                                            // gap(s) to follow
        sub x27, x27, #1                           // ...................................................................................................................................................................................................................*
        ldph x10, x12, x1, #16, t1                 // ..*.................................................................................................................................................................................................................                                                                            // gap(s) to follow
        ldp x4, x15, [x2, #0]                      // ...*................................................................................................................................................................................................................                                                                            // gap(s) to follow
        ldr q1, [x2, #16]                          // .....*..............................................................................................................................................................................................................                                                                            // gap(s) to follow
        mul x11, x9, x3                            // ......*.............................................................................................................................................................................................................                                                                            // gap(s) to follow
        uzp2 v18.4S, v1.4S, v1.4S                  // ........*...........................................................................................................................................................................................................
        dup v27.2D, x11                            // .......*............................................................................................................................................................................................................                                                                            // gap(s) to follow
        xtn v13.2S, v1.2D                          // ..........*.........................................................................................................................................................................................................
        rev64 v9.4S, v1.4S                         // ...........*........................................................................................................................................................................................................
        mul x7, x11, x4                            // ...........................*........................................................................................................................................................................................                                                                            // gap(s) to follow
        rev64 v2.4S, v1.4S                         // ....................................................................................*...............................................................................................................................
        uzp2 v20.4S, v1.4S, v1.4S                  // .................................................................................*..................................................................................................................................                                                                            // gap(s) to follow
        mul v31.4S, v9.4S, v27.4S                  // ...............*....................................................................................................................................................................................................
        xtn v14.2S, v1.2D                          // ..............................................*.....................................................................................................................................................................                                                                            // gap(s) to follow
        uzp2 v21.4S, v1.4S, v1.4S                  // ............................................*.......................................................................................................................................................................                                                                            // gap(s) to follow
        umulh x22, x11, x15                        // ................................*...................................................................................................................................................................................                                                                            // gap(s) to follow
        xtn v17.2S, v27.2D                         // .........*..........................................................................................................................................................................................................                                                                            // gap(s) to follow
        adds x19, x9, x7                           // ............................*.......................................................................................................................................................................................                                                                            // gap(s) to follow
        umull v28.2D, v17.2S, v13.2S               // ............*.......................................................................................................................................................................................................                                                                            // gap(s) to follow
        umull v26.2D, v17.2S, v18.2S               // .............*......................................................................................................................................................................................................
        uaddlp v8.2D, v31.4S                       // ..................*.................................................................................................................................................................................................                                                                            // gap(s) to follow
        umulh x8, x11, x4                          // .............................*......................................................................................................................................................................................                                                                            // gap(s) to follow
        shl v7.2D, v8.2D, #32                      // .....................*..............................................................................................................................................................................................                                                                            // gap(s) to follow
        uzp2 v30.4S, v27.4S, v27.4S                // ..............*.....................................................................................................................................................................................................
        umlal v7.2D, v17.2S, v13.2S                // .......................*............................................................................................................................................................................................
        mul x14, x11, x15                          // ..............................*.....................................................................................................................................................................................                                                                            // gap(s) to follow
        usra v26.2D, v28.2D, #32                   // ................*...................................................................................................................................................................................................                                                                            // gap(s) to follow
        umull v12.2D, v30.2S, v18.2S               // .................*..................................................................................................................................................................................................                                                                            // gap(s) to follow
        mov x24, v7.d[0]                           // .........................*..........................................................................................................................................................................................
        adcs x29, x13, x14                         // ...............................*....................................................................................................................................................................................                                                                            // gap(s) to follow
        and v4.16B, v26.16B, v29.16B               // ...................*................................................................................................................................................................................................
        mov x17, v7.d[1]                           // ..........................*.........................................................................................................................................................................................                                                                            // gap(s) to follow
        rev64 v27.4S, v1.4S                        // ...............................................*....................................................................................................................................................................                                                                            // gap(s) to follow
        adcs x5, x10, x24                          // .................................*..................................................................................................................................................................................                                                                            // gap(s) to follow
        umlal v4.2D, v30.2S, v13.2S                // ....................*...............................................................................................................................................................................................
        usra v12.2D, v26.2D, #32                   // ......................*.............................................................................................................................................................................................
        adcs x14, x12, x17                         // ..................................*.................................................................................................................................................................................                                                                            // gap(s) to follow
        adc x23, xzr, xzr                          // .....................................*..............................................................................................................................................................................                                                                            // gap(s) to follow
        adds x8, x29, x8                           // ......................................*.............................................................................................................................................................................                                                                            // gap(s) to follow
        adcs x7, x5, x22                           // .......................................*............................................................................................................................................................................
        mul x25, x8, x3                            // ..........................................*.........................................................................................................................................................................                                                                            // gap(s) to follow
        usra v12.2D, v4.2D, #32                    // ........................*...........................................................................................................................................................................................                                                                            // gap(s) to follow
        dup v8.2D, x25                             // ...........................................*........................................................................................................................................................................                                                                            // gap(s) to follow
        stph x11, x25, x1, #0, t0                  // ..............................................................................*.....................................................................................................................................                                                                            // gap(s) to follow
        mul x22, x25, x4                           // ...............................................................*....................................................................................................................................................                                                                            // gap(s) to follow
        mov x16, v12.d[1]                          // ....................................*...............................................................................................................................................................................
        ldrh q16, x1, #0, t0                       // .......................................................................................................................................*............................................................................                                                                            // gap(s) to follow
        mov x21, v12.d[0]                          // ...................................*................................................................................................................................................................................
        mul v31.4S, v27.4S, v8.4S                  // ...................................................*................................................................................................................................................................                                                                            // gap(s) to follow
        adcs x20, x14, x21                         // ........................................*...........................................................................................................................................................................                                                                            // gap(s) to follow
        xtn v27.2S, v8.2D                          // .............................................*......................................................................................................................................................................
        adc x10, x23, x16                          // .........................................*..........................................................................................................................................................................                                                                            // gap(s) to follow
        subs x14, x11, x25                         // .........................................................................................................................................*..........................................................................
        rev64 v17.4S, v16.4S                       // ...................................................................................................................................................................*................................................
        cneg x17, x14, cc                          // ..........................................................................................................................................*.........................................................................
        csetm x26, cc                              // ...........................................................................................................................................*........................................................................                                                                            // gap(s) to follow
        uaddlp v26.2D, v31.4S                      // ......................................................*.............................................................................................................................................................
        mul x6, x25, x15                           // ..................................................................*.................................................................................................................................................
        stph x17, x26, sp, #cache_a01, t01         // ............................................................................................................................................*.......................................................................                                                                            // gap(s) to follow
        umull v24.2D, v27.2S, v14.2S               // ................................................*...................................................................................................................................................................
        uzp2 v30.4S, v16.4S, v16.4S                // .................................................................................................................................................................*..................................................                                                                            // gap(s) to follow
        shl v4.2D, v26.2D, #32                     // .........................................................*..........................................................................................................................................................                                                                            // gap(s) to follow
        uzp2 v5.4S, v8.4S, v8.4S                   // ..................................................*.................................................................................................................................................................                                                                            // gap(s) to follow
        umulh x17, x25, x4                         // .................................................................*..................................................................................................................................................
        umlal v4.2D, v27.2S, v14.2S                // ...........................................................*........................................................................................................................................................                                                                            // gap(s) to follow
        umull v8.2D, v27.2S, v21.2S                // .................................................*..................................................................................................................................................................                                                                            // gap(s) to follow
        mov x21, v4.d[0]                           // .............................................................*......................................................................................................................................................                                                                            // gap(s) to follow
        adds x8, x8, x22                           // ................................................................*...................................................................................................................................................                                                                            // gap(s) to follow
        mov x12, v4.d[1]                           // ..............................................................*.....................................................................................................................................................
        ldp x23, x14, [x2, #16]                    // ....*...............................................................................................................................................................................................................
        adcs x29, x7, x6                           // ...................................................................*................................................................................................................................................
        umulh x13, x25, x15                        // ....................................................................*...............................................................................................................................................
        usra v8.2D, v24.2D, #32                    // ....................................................*...............................................................................................................................................................
        ldp x8, x24, [x30, #cache_m20]             // ...........................................................................................................................................................................................................*........                                                                            // gap(s) to follow
        adcs x9, x20, x21                          // .....................................................................*..............................................................................................................................................
        ldr q9, [x2, #32]!                         // .......................................................................................................................................................................*............................................
        xtn v28.2S, v16.2D                         // ..................................................................................................................................................................*.................................................                                                                            // gap(s) to follow
        adcs x19, x10, x12                         // ......................................................................*.............................................................................................................................................
        ldr q13, [x2, #16]                         // ........................................................................................................................................................................*...........................................
        umull v18.2D, v5.2S, v21.2S                // .....................................................*..............................................................................................................................................................
        adc x7, xzr, xzr                           // .........................................................................*..........................................................................................................................................
        adds x5, x29, x17                          // ..........................................................................*.........................................................................................................................................
        xtn v21.2S, v1.2D                          // ...................................................................................*................................................................................................................................
        mul x12, x5, x3                            // ...............................................................................*....................................................................................................................................                                                                            // gap(s) to follow
        and v4.16B, v8.16B, v29.16B                // .......................................................*............................................................................................................................................................
        adcs x21, x9, x13                          // ...........................................................................*........................................................................................................................................                                                                            // gap(s) to follow
        uzp2 v31.4S, v9.4S, v9.4S                  // ...............................................................................................................................................................................*....................................
        xtn v23.2S, v9.2D                          // .........................................................................................................................................................................*..........................................                                                                            // gap(s) to follow
        usra v18.2D, v8.2D, #32                    // ..........................................................*.........................................................................................................................................................
        umlal v4.2D, v5.2S, v14.2S                 // ........................................................*...........................................................................................................................................................                                                                            // gap(s) to follow
        dup v5.2D, x12                             // ................................................................................*...................................................................................................................................
        umull v16.2D, v23.2S, v30.2S               // ............................................................................................................................................................................*.......................................                                                                            // gap(s) to follow
        umull v1.2D, v23.2S, v28.2S                // ..............................................................................................................................................................................*.....................................
        umulh x29, x12, x15                        // .........................................................................................................*..........................................................................................................                                                                            // gap(s) to follow
        umull v8.2D, v31.2S, v30.2S                // ....................................................................................................................................................................................*...............................
        xtn v24.2S, v13.2D                         // ..........................................................................................................................................................................*.........................................                                                                            // gap(s) to follow
        mul v25.4S, v2.4S, v5.4S                   // ........................................................................................*...........................................................................................................................
        usra v18.2D, v4.2D, #32                    // ............................................................*.......................................................................................................................................................                                                                            // gap(s) to follow
        xtn v3.2S, v5.2D                           // ..................................................................................*.................................................................................................................................                                                                            // gap(s) to follow
        uzp2 v19.4S, v5.4S, v5.4S                  // .......................................................................................*............................................................................................................................
        mul x10, x12, x15                          // .......................................................................................................*............................................................................................................                                                                            // gap(s) to follow
        umull v26.2D, v3.2S, v20.2S                // ......................................................................................*.............................................................................................................................                                                                            // gap(s) to follow
        mov x22, v18.d[0]                          // .......................................................................*............................................................................................................................................
        umull v10.2D, v3.2S, v21.2S                // .....................................................................................*..............................................................................................................................                                                                            // gap(s) to follow
        uaddlp v11.2D, v25.4S                      // ...........................................................................................*........................................................................................................................
        mov x6, v18.d[1]                           // ........................................................................*...........................................................................................................................................
        mul x16, x12, x4                           // ....................................................................................................*...............................................................................................................                                                                            // gap(s) to follow
        umull v4.2D, v19.2S, v20.2S                // ..........................................................................................*.........................................................................................................................
        usra v16.2D, v1.2D, #32                    // ...................................................................................................................................................................................*................................                                                                            // gap(s) to follow
        adcs x13, x19, x22                         // ............................................................................*.......................................................................................................................................
        shl v11.2D, v11.2D, #32                    // ..............................................................................................*.....................................................................................................................
        adc x6, x7, x6                             // .............................................................................*......................................................................................................................................
        subs x7, x11, x12                          // .............................................................................................................................................*......................................................................                                                                            // gap(s) to follow
        usra v26.2D, v10.2D, #32                   // .........................................................................................*..........................................................................................................................
        csetm x26, cc                              // ...............................................................................................................................................*....................................................................
        cneg x20, x7, cc                           // ..............................................................................................................................................*.....................................................................
        subs x19, x25, x12                         // .....................................................................................................................................................*..............................................................
        umlal v11.2D, v3.2S, v21.2S                // ................................................................................................*...................................................................................................................
        cneg x9, x19, cc                           // ......................................................................................................................................................*.............................................................
        stph x20, x26, sp, #cache_a02, t02         // ................................................................................................................................................*...................................................................
        umulh x7, x12, x4                          // ......................................................................................................*.............................................................................................................
        usra v8.2D, v16.2D, #32                    // ........................................................................................................................................................................................*...........................
        mul v7.4S, v17.4S, v9.4S                   // ................................................................................................................................................................................................*...................
        csetm x26, cc                              // .......................................................................................................................................................*............................................................
        adds x19, x5, x16                          // .....................................................................................................*..............................................................................................................
        and v1.16B, v16.16B, v29.16B               // .......................................................................................................................................................................................*............................
        adcs x21, x21, x10                         // ........................................................................................................*...........................................................................................................
        stph x9, x26, sp, #cache_a12, t12          // ........................................................................................................................................................*...........................................................
        ldph x17, x20, sp, #cache_a02, t02         // .....................................................................................................................................................................................................*..............
        usra v4.2D, v26.2D, #32                    // ...............................................................................................*....................................................................................................................
        and v18.16B, v26.16B, v29.16B              // ............................................................................................*.......................................................................................................................                                                                            // gap(s) to follow
        umlal v1.2D, v31.2S, v28.2S                // ..........................................................................................................................................................................................*.........................
        mov x22, v11.d[0]                          // ..................................................................................................*.................................................................................................................                                                                            // gap(s) to follow
        mov x16, v11.d[1]                          // ...................................................................................................*................................................................................................................
        umlal v18.2D, v19.2S, v21.2S               // .............................................................................................*......................................................................................................................                                                                            // gap(s) to follow
        adcs x19, x13, x22                         // ..........................................................................................................*.........................................................................................................                                                                            // gap(s) to follow
        mul x22, x17, x8                           // ...............................................................................................................................................................................................................*....
        uaddlp v5.2D, v7.4S                        // ..................................................................................................................................................................................................*.................
        adcs x13, x6, x16                          // ...........................................................................................................*........................................................................................................                                                                            // gap(s) to follow
        usra v8.2D, v1.2D, #32                     // ..............................................................................................................................................................................................*.....................
        adc x9, xzr, xzr                           // ..............................................................................................................*.....................................................................................................
        adds x5, x21, x7                           // ...............................................................................................................*....................................................................................................                                                                            // gap(s) to follow
        usra v4.2D, v18.2D, #32                    // .................................................................................................*..................................................................................................................
        adcs x6, x19, x29                          // .................................................................................................................*..................................................................................................
        mul x19, x5, x3                            // ................................................................................................................*...................................................................................................                                                                            // gap(s) to follow
        shl v15.2D, v5.2D, #32                     // ......................................................................................................................................................................................................*.............                                                                            // gap(s) to follow
        mov x3, v8.d[1]                            // ...................................................................................................................................................................................................*................
        umlal v15.2D, v23.2S, v28.2S               // .......................................................................................................................................................................................................*............                                                                            // gap(s) to follow
        mov x21, v4.d[0]                           // ............................................................................................................*.......................................................................................................
        mul x7, x19, x23                           // .......................................................................................................................*............................................................................................                                                                            // gap(s) to follow
        stph x12, x19, x1, #16, t1                 // ....................................................................................................................*...............................................................................................
        mov x10, v4.d[1]                           // .............................................................................................................*......................................................................................................                                                                            // gap(s) to follow
        ldrh q9, x1, #16, t1                       // ........................................................................................................................................*...........................................................................
        adcs x13, x13, x21                         // ..................................................................................................................*.................................................................................................                                                                            // gap(s) to follow
        mov x21, v15.d[1]                          // ............................................................................................................................................................................................................*.......
        mul x16, x19, x4                           // .....................................................................................................................*..............................................................................................
        adc x9, x9, x10                            // ...................................................................................................................*................................................................................................
        subs x29, x25, x19                         // .........................................................................................................................................................*..........................................................                                                                            // gap(s) to follow
        csetm x26, cc                              // ...........................................................................................................................................................*........................................................
        cneg x10, x29, cc                          // ..........................................................................................................................................................*.........................................................                                                                            // gap(s) to follow
        subs x29, x12, x19                         // .............................................................................................................................................................*......................................................
        stph x10, x26, sp, #cache_a13, t13         // ............................................................................................................................................................*.......................................................                                                                            // gap(s) to follow
        uzp2 v18.4S, v9.4S, v9.4S                  // ....................................................................................................................................................................*...............................................                                                                            // gap(s) to follow
        mul x12, x19, x15                          // ......................................................................................................................*.............................................................................................
        rev64 v20.4S, v9.4S                        // ......................................................................................................................................................................*.............................................
        xtn v19.2S, v9.2D                          // .....................................................................................................................................................................*..............................................                                                                            // gap(s) to follow
        umull v25.2D, v24.2S, v18.2S               // .............................................................................................................................................................................*......................................                                                                            // gap(s) to follow
        csetm x26, cc                              // ...............................................................................................................................................................*....................................................
        umull v14.2D, v24.2S, v19.2S               // ................................................................................................................................................................................*...................................
        cneg x29, x29, cc                          // ..............................................................................................................................................................*.....................................................
        umulh x10, x19, x23                        // ..............................................................................................................................*.....................................................................................
        adds x25, x5, x16                          // .........................................................................................................................*..........................................................................................
        mul v7.4S, v20.4S, v13.4S                  // .................................................................................................................................................................................*..................................
        adcs x12, x6, x12                          // ...........................................................................................................................*........................................................................................                                                                            // gap(s) to follow
        ldph x6, x5, sp, #cache_a01, t01           // ..........................................................................................................................................................................................................*.........
        mov x16, v8.d[0]                           // .........................................................................................................................................................................................................*..........
        adcs x25, x13, x7                          // .............................................................................................................................*......................................................................................
        stph x29, x26, sp, #cache_a23, t23         // ................................................................................................................................................................*...................................................                                                                            // gap(s) to follow
        usra v25.2D, v14.2D, #32                   // .....................................................................................................................................................................................*..............................                                                                            // gap(s) to follow
        mul x29, x19, x14                          // ........................................................................................................................*...........................................................................................
        uzp2 v1.4S, v13.4S, v13.4S                 // ...........................................................................................................................................................................*........................................                                                                            // gap(s) to follow
        uaddlp v7.2D, v7.4S                        // ......................................................................................................................................................................................*.............................                                                                            // gap(s) to follow
        umull v0.2D, v1.2S, v18.2S                 // ..................................................................................................................................................................................*.................................                                                                            // gap(s) to follow
        umulh x13, x19, x4                         // ..........................................................................................................................*.........................................................................................
        and v10.16B, v25.16B, v29.16B              // .........................................................................................................................................................................................*..........................
        shl v13.2D, v7.2D, #32                     // ............................................................................................................................................................................................*.......................                                                                            // gap(s) to follow
        adcs x4, x9, x29                           // ...............................................................................................................................*....................................................................................                                                                            // gap(s) to follow
        umlal v10.2D, v1.2S, v19.2S                // .............................................................................................................................................................................................*......................
        adc x9, xzr, xzr                           // .................................................................................................................................*..................................................................................                                                                            // gap(s) to follow
        subs x29, x11, x19                         // .................................................................................................................................................*..................................................................
        usra v0.2D, v25.2D, #32                    // ...........................................................................................................................................................................................*........................
        eor x11, x20, x24                          // ................................................................................................................................................................................................................*...                                                                            // gap(s) to follow
        umulh x15, x19, x15                        // ............................................................................................................................*.......................................................................................
        umlal v13.2D, v24.2S, v19.2S               // ...............................................................................................................................................................................................*....................
        cneg x7, x29, cc                           // ..................................................................................................................................................*.................................................................                                                                            // gap(s) to follow
        ldp x20, x29, [x1, #32]!                   // .................................................................................................................................................................................................................*..
        csetm x26, cc                              // ...................................................................................................................................................*................................................................                                                                            // gap(s) to follow
        usra v0.2D, v10.2D, #32                    // .................................................................................................................................................................................................*..................
        umulh x19, x19, x14                        // ................................................................................................................................*...................................................................................                                                                            // gap(s) to follow
        mov x23, v13.d[1]                          // .............................................................................................................................................................................................................*......                                                                            // gap(s) to follow
        stph x7, x26, sp, #cache_a03, t03          // ....................................................................................................................................................*...............................................................                                                                            // gap(s) to follow
        adds x12, x12, x13                         // ..................................................................................................................................*.................................................................................                                                                            // gap(s) to follow
        adcs x13, x25, x15                         // ...................................................................................................................................*................................................................................                                                                            // gap(s) to follow
        mov x26, v0.d[0]                           // ....................................................................................................................................................................................................*...............
        umulh x8, x17, x8                          // ..................................................................................................................................................................................................................*.
        adcs x14, x4, x10                          // ....................................................................................................................................*...............................................................................                                                                            // gap(s) to follow
        mov x17, v13.d[0]                          // ........................................................................................................................................................................................................*...........
        adc x15, x9, x19                           // .....................................................................................................................................*..............................................................................
        ldp x24, x10, [x30], #96                   // ..............................................................................................................................................................................................................*.....                                                                            // gap(s) to follow

        // original source code
        // ldr x3, [sp]                                      // .*.................................................................................................................................................................................................................. || *....................................................
        // ldph x17, x19, x1, #0, t0                         // *................................................................................................................................................................................................................... || *....................................................
        // ldph x20, x21, x1, #16, t1                        // ....*............................................................................................................................................................................................................... || .*...................................................
        // ldp x8, x9, [x2, #0]                              // .....*.............................................................................................................................................................................................................. || .*...................................................
        // ldp x10, x11, [x2, #16]                           // ........................................................................*........................................................................................................................................... || ..................*..................................
        // ldr q21, [x2, #16]                                // ......*............................................................................................................................................................................................................. || .*...................................................
        // mul x4, x17, x3                                   // .......*............................................................................................................................................................................................................ || .*...................................................
        // dup     V<in1>.2d, x4                             // .........*.......................................................................................................................................................................................................... || ..*..................................................
        // uzp2    V<in0_p>.4s, v21.4s, v21.4s               // ........*........................................................................................................................................................................................................... || ..*..................................................
        // xtn     V<tmp0>.2s, V<in1>.2d                     // ...................*................................................................................................................................................................................................ || ....*................................................
        // xtn     V<in0_pp>.2s, v21.2d                      // ..........*......................................................................................................................................................................................................... || ..*..................................................
        // rev64   V<in0_ppp>.4s, v21.4s                     // ...........*........................................................................................................................................................................................................ || ..*..................................................
        // umull   V<tmp1>.2d, V<tmp0>.2s, V<in0_pp>.2s      // .....................*.............................................................................................................................................................................................. || .....*...............................................
        // umull   V<tmp2>.2d, V<tmp0>.2s, V<in0_p>.2s       // ......................*............................................................................................................................................................................................. || .....*...............................................
        // uzp2    V<tmp3>.4s, V<in1>.4s, V<in1>.4s          // ..........................*......................................................................................................................................................................................... || ......*..............................................
        // mul     V<in1>.4s, V<in0_ppp>.4s, V<in1>.4s       // ...............*.................................................................................................................................................................................................... || ...*.................................................
        // usra    V<tmp2>.2d, V<tmp1>.2d, #32               // .............................*...................................................................................................................................................................................... || .......*.............................................
        // umull   v1.2d, V<tmp3>.2s, V<in0_p>.2s            // ..............................*..................................................................................................................................................................................... || .......*.............................................
        // uaddlp  V<in1>.2d, V<in1>.4s                      // .......................*............................................................................................................................................................................................ || .....*...............................................
        // and     V<tmp4>.16b, V<tmp2>.16b, v29.16b         // .................................*.................................................................................................................................................................................. || ........*............................................
        // umlal   V<tmp4>.2d, V<tmp3>.2s, V<in0_pp>.2s      // .....................................*.............................................................................................................................................................................. || .........*...........................................
        // shl     v0.2d, V<in1>.2d, #32                     // .........................*.......................................................................................................................................................................................... || ......*..............................................
        // usra    v1.2d, V<tmp2>.2d, #32                    // ......................................*............................................................................................................................................................................. || .........*...........................................
        // umlal   v0.2d, V<tmp0>.2s, V<in0_pp>.2s           // ...........................*........................................................................................................................................................................................ || ......*..............................................
        // usra    v1.2d, V<tmp4>.2d, #32                    // ............................................*....................................................................................................................................................................... || ...........*.........................................
        // mov x14, v0.d[0]                                  // ...............................*.................................................................................................................................................................................... || .......*.............................................
        // mov x15, v0.d[1]                                  // ..................................*................................................................................................................................................................................. || ........*............................................
        // mul	x12, x4, x8                                  // ............*....................................................................................................................................................................................................... || ...*.................................................
        // adds x17, x17, x12                                // ....................*............................................................................................................................................................................................... || .....*...............................................
        // umulh x12, x4, x8                                 // ........................*........................................................................................................................................................................................... || ......*..............................................
        // mul	x13, x4, x9                                  // ............................*....................................................................................................................................................................................... || .......*.............................................
        // adcs x19, x19, x13                                // ................................*................................................................................................................................................................................... || ........*............................................
        // umulh x13, x4, x9                                 // ..................*................................................................................................................................................................................................. || ....*................................................
        // adcs x20, x20, x14                                // ....................................*............................................................................................................................................................................... || .........*...........................................
        // adcs x21, x21, x15                                // .......................................*............................................................................................................................................................................ || .........*...........................................
        // mov x14, v1.d[0]                                  // ..................................................*................................................................................................................................................................. || ............*........................................
        // mov x15, v1.d[1]                                  // ................................................*................................................................................................................................................................... || ............*........................................
        // adc x22, xzr, xzr                                 // ........................................*........................................................................................................................................................................... || ..........*..........................................
        // adds x19, x19, x12                                // .........................................*.......................................................................................................................................................................... || ..........*..........................................
        // adcs x20, x20, x13                                // ..........................................*......................................................................................................................................................................... || ..........*..........................................
        // adcs x21, x21, x14                                // ....................................................*............................................................................................................................................................... || .............*.......................................
        // adc x22, x22, x15                                 // ......................................................*............................................................................................................................................................. || .............*.......................................
        // mul x5, x19, x3                                   // ...........................................*........................................................................................................................................................................ || ..........*..........................................
        // dup     V<in1>.2d, x5                             // .............................................*...................................................................................................................................................................... || ...........*.........................................
        // uzp2    V<in0_p>.4s, v21.4s, v21.4s               // .................*.................................................................................................................................................................................................. || ....*................................................
        // xtn     V<tmp0>.2s, V<in1>.2d                     // .....................................................*.............................................................................................................................................................. || .............*.......................................
        // xtn     V<in0_pp>.2s, v21.2d                      // ................*................................................................................................................................................................................................... || ....*................................................
        // rev64   V<in0_ppp>.4s, v21.4s                     // ...................................*................................................................................................................................................................................ || ........*............................................
        // umull   V<tmp1>.2d, V<tmp0>.2s, V<in0_pp>.2s      // ..............................................................*..................................................................................................................................................... || ...............*.....................................
        // umull   V<tmp2>.2d, V<tmp0>.2s, V<in0_p>.2s       // ....................................................................*............................................................................................................................................... || .................*...................................
        // uzp2    V<tmp3>.4s, V<in1>.4s, V<in1>.4s          // .................................................................*.................................................................................................................................................. || ................*....................................
        // mul     V<in1>.4s, V<in0_ppp>.4s, V<in1>.4s       // ...................................................*................................................................................................................................................................ || ............*........................................
        // usra    V<tmp2>.2d, V<tmp1>.2d, #32               // ...........................................................................*........................................................................................................................................ || ..................*..................................
        // umull   v1.2d, V<tmp3>.2s, V<in0_p>.2s            // ..................................................................................*................................................................................................................................. || ....................*................................
        // uaddlp  V<in1>.2d, V<in1>.4s                      // ...........................................................*........................................................................................................................................................ || ..............*......................................
        // and     V<tmp4>.16b, V<tmp2>.16b, v29.16b         // .......................................................................................*............................................................................................................................ || .....................*...............................
        // umlal   V<tmp4>.2d, V<tmp3>.2s, V<in0_pp>.2s      // ............................................................................................*....................................................................................................................... || .......................*.............................
        // shl     v0.2d, V<in1>.2d, #32                     // ................................................................*................................................................................................................................................... || ................*....................................
        // usra    v1.2d, V<tmp2>.2d, #32                    // ...........................................................................................*........................................................................................................................ || ......................*..............................
        // umlal   v0.2d, V<tmp0>.2s, V<in0_pp>.2s           // ...................................................................*................................................................................................................................................ || ................*....................................
        // usra    v1.2d, V<tmp4>.2d, #32                    // ....................................................................................................*............................................................................................................... || .........................*...........................
        // mov x14, v0.d[0]                                  // .....................................................................*.............................................................................................................................................. || .................*...................................
        // mov x15, v0.d[1]                                  // .......................................................................*............................................................................................................................................ || .................*...................................
        // mul	x12, x5, x8                                  // ...............................................*.................................................................................................................................................................... || ...........*.........................................
        // adds	x19, x19, x12                                // ......................................................................*............................................................................................................................................. || .................*...................................
        // umulh	x12, x5, x8                          // ..................................................................*................................................................................................................................................. || ................*....................................
        // mul	x13, x5, x9                                  // ............................................................*....................................................................................................................................................... || ...............*.....................................
        // adcs	x20, x20, x13                                // .........................................................................*.......................................................................................................................................... || ..................*..................................
        // umulh	x13, x5, x9                          // ..........................................................................*......................................................................................................................................... || ..................*..................................
        // adcs x21, x21, x14                                // .............................................................................*...................................................................................................................................... || ...................*.................................
        // adcs x22, x22, x15                                // ................................................................................*................................................................................................................................... || ....................*................................
        // mov x14, v1.d[0]                                  // .........................................................................................................*.......................................................................................................... || ..........................*..........................
        // mov x15, v1.d[1]                                  // ............................................................................................................*....................................................................................................... || ...........................*.........................
        // adc x23, xzr, xzr                                 // ...................................................................................*................................................................................................................................ || ....................*................................
        // adds x20, x20, x12                                // ....................................................................................*............................................................................................................................... || .....................*...............................
        // adcs x21, x21, x13                                // ........................................................................................*........................................................................................................................... || ......................*..............................
        // adcs x22, x22, x14                                // ................................................................................................................*................................................................................................... || ............................*........................
        // adc x23, x23, x15                                 // ..................................................................................................................*................................................................................................. || ............................*........................
        // stph x4, x5, x1, #0, t0                           // ..............................................*..................................................................................................................................................................... || ...........*.........................................
        // mul	x6, x20, x3                                  // ......................................................................................*............................................................................................................................. || .....................*...............................
        // dup     V<in1>.2d, x6                             // .............................................................................................*...................................................................................................................... || .......................*.............................
        // uzp2    V<in0_p>.4s, v21.4s, v21.4s               // ..............*..................................................................................................................................................................................................... || ...*.................................................
        // xtn     V<tmp0>.2s, V<in1>.2d                     // .....................................................................................................*.............................................................................................................. || .........................*...........................
        // xtn     V<in0_pp>.2s, v21.2d                      // .....................................................................................*.............................................................................................................................. || .....................*...............................
        // rev64   V<in0_ppp>.4s, v21.4s                     // .............*...................................................................................................................................................................................................... || ...*.................................................
        // umull   V<tmp1>.2d, V<tmp0>.2s, V<in0_pp>.2s      // ..........................................................................................................*......................................................................................................... || ..........................*..........................
        // umull   V<tmp2>.2d, V<tmp0>.2s, V<in0_p>.2s       // ........................................................................................................*........................................................................................................... || ..........................*..........................
        // uzp2    V<tmp3>.4s, V<in1>.4s, V<in1>.4s          // ......................................................................................................*............................................................................................................. || .........................*...........................
        // mul     V<in1>.4s, V<in0_ppp>.4s, V<in1>.4s       // ...................................................................................................*................................................................................................................ || ........................*............................
        // usra    V<tmp2>.2d, V<tmp1>.2d, #32               // ....................................................................................................................*............................................................................................... || .............................*.......................
        // umull   v1.2d, V<tmp3>.2s, V<in0_p>.2s            // ..............................................................................................................*..................................................................................................... || ...........................*.........................
        // uaddlp  V<in1>.2d, V<in1>.4s                      // ...........................................................................................................*........................................................................................................ || ..........................*..........................
        // and     V<tmp4>.16b, V<tmp2>.16b, v29.16b         // .....................................................................................................................................*.............................................................................. || .................................*...................
        // umlal   V<tmp4>.2d, V<tmp3>.2s, V<in0_pp>.2s      // .........................................................................................................................................*.......................................................................... || ..................................*..................
        // shl     v21.2d, V<in1>.2d, #32                    // .................................................................................................................*.................................................................................................. || ............................*........................
        // usra    v1.2d, V<tmp2>.2d, #32                    // ....................................................................................................................................*............................................................................... || .................................*...................
        // umlal   v21.2d, V<tmp0>.2s, V<in0_pp>.2s          // ........................................................................................................................*........................................................................................... || ..............................*......................
        // usra    v1.2d, V<tmp4>.2d, #32                    // .................................................................................................................................................*.................................................................. || ....................................*................
        // mov   x14, v21.d[0]                               // .......................................................................................................................................*............................................................................ || .................................*...................
        // mov   x15, v21.d[1]                               // ........................................................................................................................................*........................................................................... || ..................................*..................
        // mul	x12, x6, x8                                  // .............................................................................................................*...................................................................................................... || ...........................*.........................
        // adds	x20, x20, x12                                // ...............................................................................................................................*.................................................................................... || ...............................*.....................
        // umulh	x12, x6, x8                          // ...........................................................................................................................*........................................................................................ || ..............................*......................
        // mul	x13, x6, x9                                  // .......................................................................................................*............................................................................................................ || .........................*...........................
        // adcs	x21, x21, x13                                // .................................................................................................................................*.................................................................................. || ................................*....................
        // umulh	x13, x6, x9                          // ................................................................................................*................................................................................................................... || ........................*............................
        // adcs  x22, x22, x14                               // ..........................................................................................................................................*......................................................................... || ..................................*..................
        // adcs  x23, x23, x15                               // .............................................................................................................................................*...................................................................... || ...................................*.................
        // mov   x14, v1.d[0]                                // .......................................................................................................................................................*............................................................ || .....................................*...............
        // mov   x15, v1.d[1]                                // ..........................................................................................................................................................*......................................................... || ......................................*..............
        // adc	x24, xzr, xzr                                // ...............................................................................................................................................*.................................................................... || ...................................*.................
        // adds	x21, x21, x12                                // ................................................................................................................................................*................................................................... || ....................................*................
        // mul	x7, x21, x3                                  // ...................................................................................................................................................*................................................................ || ....................................*................
        // adcs	x22, x22, x13                                // ..................................................................................................................................................*................................................................. || ....................................*................
        // adcs	x23, x23, x14                                // ............................................................................................................................................................*....................................................... || .......................................*.............
        // adc	x24, x24, x15                                // ...............................................................................................................................................................*.................................................... || .......................................*.............
        // stph x6, x7, x1, #16, t1                          // .........................................................................................................................................................*.......................................................... || ......................................*..............
        // mul	x12, x7, x8                                  // ..............................................................................................................................................................*..................................................... || .......................................*.............
        // mul	x13, x7, x9                                  // ......................................................................................................................................................................*............................................. || .........................................*...........
        // mul	x14, x7, x10                                 // ........................................................................................................................................................*........................................................... || ......................................*..............
        // mul	x15, x7, x11                                 // ......................................................................................................................................................................................*............................. || .............................................*.......
        // adds	x21, x21, x12                                // ..............................................................................................................................................................................*..................................... || ...........................................*.........
        // umulh	x12, x7, x8                          // ..........................................................................................................................................................................................*......................... || ..............................................*......
        // adcs	x22, x22, x13                                // ................................................................................................................................................................................*................................... || ............................................*........
        // umulh	x13, x7, x9                          // ...................................................................................................................................................................................................*................ || ................................................*....
        // adcs	x23, x23, x14                                // ...................................................................................................................................................................................*................................ || ............................................*........
        // umulh	x14, x7, x10                         // .............................................................................................................................................................................*...................................... || ...........................................*.........
        // adcs	x24, x24, x15                                // .............................................................................................................................................................................................*...................... || ...............................................*.....
        // umulh	x15, x7, x11                         // .........................................................................................................................................................................................................*.......... || ..................................................*..
        // adc	x25, xzr, xzr                                // ...............................................................................................................................................................................................*.................... || ...............................................*.....
        // adds	x12, x22, x12                                // ............................................................................................................................................................................................................*....... || ...................................................*.
        // adcs	x13, x23, x13                                // .............................................................................................................................................................................................................*...... || ...................................................*.
        // adcs	x14, x24, x14                                // ................................................................................................................................................................................................................*... || ....................................................*
        // adc	x15, x25, x15                                // ..................................................................................................................................................................................................................*. || ....................................................*
        // lsr x27, x0, #5                                   // ..*................................................................................................................................................................................................................. || *....................................................
        // ldrh q20, x1, #0, t0                              // .................................................*.................................................................................................................................................................. || ............*........................................
        // ldrh q21, x1, #16, t1                             // ...........................................................................................................................................................*........................................................ || ......................................*..............
        // subs    x16, x4, x5                               // .......................................................*............................................................................................................................................................ || .............*.......................................
        // cneg    x16, x16, cc                              // .........................................................*.......................................................................................................................................................... || ..............*......................................
        // csetm   x26, cc                                   // ..........................................................*......................................................................................................................................................... || ..............*......................................
        // stph x16, x26, sp, #cache_a01, t01                // .............................................................*...................................................................................................................................................... || ...............*.....................................
        // subs    x16, x4, x6                               // ...................................................................................................................*................................................................................................ || ............................*........................
        // cneg    x16, x16, cc                              // ......................................................................................................................*............................................................................................. || .............................*.......................
        // csetm   x26, cc                                   // .....................................................................................................................*.............................................................................................. || .............................*.......................
        // stph x16, x26, sp, #cache_a02, t02                // ..........................................................................................................................*......................................................................................... || ..............................*......................
        // subs    x16, x4, x7                               // ................................................................................................................................................................................................*................... || ................................................*....
        // cneg    x16, x16, cc                              // .....................................................................................................................................................................................................*.............. || .................................................*...
        // csetm   x26, cc                                   // .......................................................................................................................................................................................................*............ || .................................................*...
        // stph x16, x26, sp, #cache_a03, t03                // ...........................................................................................................................................................................................................*........ || ..................................................*..
        // subs    x16, x5, x6                               // .......................................................................................................................*............................................................................................ || .............................*.......................
        // cneg    x16, x16, cc                              // .........................................................................................................................*.......................................................................................... || ..............................*......................
        // csetm   x26, cc                                   // ..............................................................................................................................*..................................................................................... || ...............................*.....................
        // stph x16, x26, sp, #cache_a12, t12                // ..................................................................................................................................*................................................................................. || ................................*....................
        // subs    x16, x5, x7                               // ................................................................................................................................................................*................................................... || ........................................*............
        // cneg    x16, x16, cc                              // ..................................................................................................................................................................*................................................. || ........................................*............
        // csetm   x26, cc                                   // .................................................................................................................................................................*.................................................. || ........................................*............
        // stph x16, x26, sp, #cache_a13, t13                // ....................................................................................................................................................................*............................................... || .........................................*...........
        // subs    x16, x6, x7                               // ...................................................................................................................................................................*................................................ || ........................................*............
        // cneg    x16, x16, cc                              // ............................................................................................................................................................................*....................................... || ...........................................*.........
        // csetm   x26, cc                                   // ..........................................................................................................................................................................*......................................... || ..........................................*..........
        // stph x16, x26, sp, #cache_a23, t23                // ....................................................................................................................................................................................*............................... || .............................................*.......
        // uzp2    v30.4s, v20.4s, v20.4s                    // ...............................................................*.................................................................................................................................................... || ...............*.....................................
        // xtn     v28.2s, v20.2d                            // ...............................................................................*.................................................................................................................................... || ...................*.................................
        // rev64   v17.4s, v20.4s                            // ........................................................*........................................................................................................................................................... || ..............*......................................
        // uzp2    v18.4s, v21.4s, v21.4s                    // .....................................................................................................................................................................*.............................................. || .........................................*...........
        // xtn     v19.2s, v21.2d                            // ........................................................................................................................................................................*........................................... || ..........................................*..........
        // rev64   v20.4s, v21.4s                            // .......................................................................................................................................................................*............................................ || .........................................*...........
        // ldr q14, [x2, #32]!                               // ..............................................................................*..................................................................................................................................... || ...................*.................................
        // ldr q25, [x2, #16]                                // .................................................................................*.................................................................................................................................. || ....................*................................
        // xtn v21.2S, v14.2D                                // ..........................................................................................*......................................................................................................................... || ......................*..............................
        // xtn v31.2S, v25.2D                                // ..................................................................................................*................................................................................................................. || ........................*............................
        // uzp2 v24.4S, v25.4S, v25.4S                       // .......................................................................................................................................................................................*............................ || .............................................*.......
        // umull v5.2D, v21.2S, v30.2S                       // ..............................................................................................*..................................................................................................................... || .......................*.............................
        // umull v16.2D, v31.2S, v18.2S                      // .........................................................................................................................................................................*.......................................... || ..........................................*..........
        // umull v13.2D, v21.2S, v28.2S                      // ...............................................................................................*.................................................................................................................... || .......................*.............................
        // uzp2 v10.4S, v14.4S, v14.4S                       // .........................................................................................*.......................................................................................................................... || ......................*..............................
        // umull v1.2D, v31.2S, v19.2S                       // ...........................................................................................................................................................................*........................................ || ..........................................*..........
        // mul v6.4S, v20.4S, v25.4S                         // ...............................................................................................................................................................................*.................................... || ...........................................*.........
        // umull v0.2D, v24.2S, v18.2S                       // .........................................................................................................................................................................................*.......................... || ..............................................*......
        // usra v5.2D, v13.2D, #32                           // ...............................................................................................................*.................................................................................................... || ...........................*.........................
        // umull v2.2D, v10.2S, v30.2S                       // .................................................................................................*.................................................................................................................. || ........................*............................
        // usra v16.2D, v1.2D, #32                           // .....................................................................................................................................................................................*.............................. || .............................................*.......
        // uaddlp v13.2D, v6.4S                              // ........................................................................................................................................................................................*........................... || ..............................................*......
        // and v7.16B, v5.16B, v29.16B                       // ................................................................................................................................*................................................................................... || ................................*....................
        // usra v2.2D, v5.2D, #32                            // ............................................................................................................................*....................................................................................... || ...............................*.....................
        // and v25.16B, v16.16B, v29.16B                     // ...........................................................................................................................................................................................*........................ || ..............................................*......
        // umlal v7.2D, v10.2S, v28.2S                       // ......................................................................................................................................*............................................................................. || .................................*...................
        // usra v0.2D, v16.2D, #32                           // .................................................................................................................................................................................................*.................. || ................................................*....
        // shl v16.2D, v13.2D, #32                           // ............................................................................................................................................................................................*....................... || ...............................................*.....
        // umlal v25.2D, v24.2S, v19.2S                      // ..............................................................................................................................................................................................*..................... || ...............................................*.....
        // usra v2.2D, v7.2D, #32                            // ..............................................................................................................................................*..................................................................... || ...................................*.................
        // umlal v16.2D, v31.2S, v19.2S                      // ....................................................................................................................................................................................................*............... || .................................................*...
        // mul v7.4S, v17.4S, v14.4S                         // .............................................................................................................................*...................................................................................... || ...............................*.....................
        // usra v0.2D, v25.2D, #32                           // ........................................................................................................................................................................................................*........... || ..................................................*..
        // uaddlp v10.2D, v7.4S                              // ............................................................................................................................................*....................................................................... || ...................................*.................
        // mov x3, v2.d[1]                                   // .....................................................................................................................................................*.............................................................. || .....................................*...............
        // mov x26, v0.d[0]                                  // ..............................................................................................................................................................................................................*..... || ...................................................*.
        // ldph x9, x20, sp, #cache_a02, t02                 // ...................................................................................................................................*................................................................................ || ................................*....................
        // shl v15.2D, v10.2D, #32                           // ....................................................................................................................................................*............................................................... || .....................................*...............
        // umlal v15.2D, v21.2S, v28.2S                      // ......................................................................................................................................................*............................................................. || .....................................*...............
        // mov x17, v16.d[0]                                 // .................................................................................................................................................................................................................*.. || ....................................................*
        // mov x16, v2.d[0]                                  // ..................................................................................................................................................................................*................................. || ............................................*........
        // ldph x6, x5, sp, #cache_a01, t01                  // .................................................................................................................................................................................*.................................. || ............................................*........
        // ldp x7, x25, [x30, #cache_m20]                    // ............................................................................*....................................................................................................................................... || ...................*.................................
        // mov x21, v15.d[1]                                 // .............................................................................................................................................................*...................................................... || .......................................*.............
        // mov x23, v16.d[1]                                 // ..........................................................................................................................................................................................................*......... || ..................................................*..
        // ldp x24, x10, [x30], #96                          // ...................................................................................................................................................................................................................* || ....................................................*
        // mul x22, x9, x7                                   // ...........................................................................................................................................*........................................................................ || ..................................*..................
        // eor x11, x20, x25                                 // ..................................................................................................................................................................................................*................. || ................................................*....
        // ldp x20, x29, [x1, #32]!                          // ......................................................................................................................................................................................................*............. || .................................................*...
        // umulh x8, x9, x7                                  // ...............................................................................................................................................................................................................*.... || ...................................................*.
        // sub x27, x27, #1                                  // ...*................................................................................................................................................................................................................ || *....................................................

        bignum_emontredc_8n_neon_maddloop_neon:


        ldr q14, [x2, #32]!                          // e....................................................................................................................................................
        ldr q25, [x2, #16]                           // .e...................................................................................................................................................
        eor x19, x5, x10                             // .................................................................................*...................................................................
        adds x25, x21, x16                           // .....................................*...............................................................................................................
        mov x16, v0.d[1]                             // .................................*...................................................................................................................
        ldp x4, x7, [x1, #16]                        // .............................................*.......................................................................................................
        adcs x21, x17, x3                            // ......................................*..............................................................................................................
        // gap                                       // .....................................................................................................................................................
        // gap                                       // .....................................................................................................................................................
        eor x22, x22, x11                            // .................................................................................................................*...................................
        // gap                                       // .....................................................................................................................................................
        adcs x23, x23, x26                           // .......................................*.............................................................................................................
        // gap                                       // .....................................................................................................................................................
        adc x17, x16, xzr                            // ........................................*............................................................................................................
        adds x16, x12, x20                           // ...........................................*.........................................................................................................
        mul x5, x6, x24                              // ..................................................................................*..................................................................
        xtn v21.2S, v14.2D                           // ..e..................................................................................................................................................
        xtn v31.2S, v25.2D                           // ................e....................................................................................................................................
        adcs x9, x13, x29                            // ............................................*........................................................................................................
        // gap                                       // .....................................................................................................................................................
        uzp2 v24.4S, v25.4S, v25.4S                  // ...................e.................................................................................................................................
        mov x29, v15.d[0]                            // .........................................*...........................................................................................................
        adcs x4, x14, x4                             // ..............................................*......................................................................................................
        ldph x10, x13, sp, #cache_a23, t23           // ....................................................................*................................................................................
        umull v5.2D, v21.2S, v30.2S                  // ....e................................................................................................................................................
        umulh x20, x6, x24                           // ...................................................................................*.................................................................
        adcs x24, x15, x7                            // ...............................................*.....................................................................................................
        ldp x12, x7, [x30, #cache_m32 - 96]          // .....................................................................*...............................................................................
        umull v16.2D, v31.2S, v18.2S                 // ..................e..................................................................................................................................
        adc x6, xzr, xzr                             // ................................................*....................................................................................................
        adds x14, x25, x29                           // .................................................*...................................................................................................
        // gap                                       // .....................................................................................................................................................
        umull v13.2D, v21.2S, v28.2S                 // ...e.................................................................................................................................................
        uzp2 v10.4S, v14.4S, v14.4S                  // .....e...............................................................................................................................................
        eor x15, x8, x11                             // ...................................................................................................................*.................................
        adcs x25, x21, x25                           // ..................................................*..................................................................................................
        umull v1.2D, v31.2S, v19.2S                  // .................e...................................................................................................................................
        adcs x8, x23, x21                            // ...................................................*.................................................................................................
        // gap                                       // .....................................................................................................................................................
        // gap                                       // .....................................................................................................................................................
        mul v6.4S, v20.4S, v25.4S                    // ....................e................................................................................................................................
        eor x7, x13, x7                              // ......................................................................*..............................................................................
        adcs x23, x17, x23                           // ....................................................*................................................................................................
        eor x21, x5, x19                             // .....................................................................................*...............................................................
        // gap                                       // .....................................................................................................................................................
        adc x13, xzr, x17                            // .....................................................*...............................................................................................
        // gap                                       // .....................................................................................................................................................
        adds x17, x25, x29                           // ......................................................*..............................................................................................
        umull v0.2D, v24.2S, v18.2S                  // ......................e..............................................................................................................................
        usra v5.2D, v13.2D, #32                      // .......e.............................................................................................................................................
        // gap                                       // .....................................................................................................................................................
        adcs x5, x8, x14                             // .......................................................*.............................................................................................
        umull v2.2D, v10.2S, v30.2S                  // ........e............................................................................................................................................
        adcs x25, x23, x25                           // ........................................................*............................................................................................
        // gap                                       // .....................................................................................................................................................
        // gap                                       // .....................................................................................................................................................
        usra v16.2D, v1.2D, #32                      // .....................e...............................................................................................................................
        adcs x8, x13, x8                             // .........................................................*...........................................................................................
        // gap                                       // .....................................................................................................................................................
        // gap                                       // .....................................................................................................................................................
        uaddlp v13.2D, v6.4S                         // .......................e.............................................................................................................................
        adcs x23, xzr, x23                           // ..........................................................*..........................................................................................
        // gap                                       // .....................................................................................................................................................
        // gap                                       // .....................................................................................................................................................
        and v7.16B, v5.16B, v29.16B                  // ..........e..........................................................................................................................................
        adc x13, xzr, x13                            // ...........................................................*.........................................................................................
        adds x29, x29, x16                           // ............................................................*........................................................................................
        mul x16, x10, x12                            // .......................................................................*.............................................................................
        // gap                                       // .....................................................................................................................................................
        usra v2.2D, v5.2D, #32                       // .............e.......................................................................................................................................
        // gap                                       // .....................................................................................................................................................
        adcs x9, x14, x9                             // .............................................................*.......................................................................................
        and v25.16B, v16.16B, v29.16B                // ........................e............................................................................................................................
        adcs x17, x17, x4                            // ..............................................................*......................................................................................
        // gap                                       // .....................................................................................................................................................
        // gap                                       // .....................................................................................................................................................
        umlal v7.2D, v10.2S, v28.2S                  // ...........e.........................................................................................................................................
        umulh x12, x10, x12                          // ........................................................................*............................................................................
        // gap                                       // .....................................................................................................................................................
        adcs x10, x5, x24                            // ...............................................................*.....................................................................................
        usra v0.2D, v16.2D, #32                      // ...........................e.........................................................................................................................
        eor x5, x16, x7                              // ..........................................................................*..........................................................................
        ldp x16, x14, [x30, #cache_m31 - 96]         // ................................................................................................*....................................................
        adcs x6, x25, x6                             // ................................................................*....................................................................................
        shl v16.2D, v13.2D, #32                      // ..........................e..........................................................................................................................
        eor x24, x20, x19                            // .......................................................................................*.............................................................
        adcs x4, x8, xzr                             // .................................................................*...................................................................................
        ldph x20, x25, sp, #cache_a13, t13           // ...............................................................................................*.....................................................
        umlal v25.2D, v24.2S, v19.2S                 // .........................e...........................................................................................................................
        adcs x23, x23, xzr                           // ..................................................................*..................................................................................
        // gap                                       // .....................................................................................................................................................
        // gap                                       // .....................................................................................................................................................
        usra v2.2D, v7.2D, #32                       // ...............e.....................................................................................................................................
        umlal v16.2D, v31.2S, v19.2S                 // ............................e........................................................................................................................
        adc x8, x13, xzr                             // ...................................................................*.................................................................................
        adds xzr, x7, #1                             // .........................................................................*...........................................................................
        mul v7.4S, v17.4S, v14.4S                    // ......e..............................................................................................................................................
        adcs x4, x4, x5                              // ...........................................................................*.........................................................................
        eor x5, x12, x7                              // ............................................................................*........................................................................
        // gap                                       // .....................................................................................................................................................
        // gap                                       // .....................................................................................................................................................
        adcs x23, x23, x5                            // .............................................................................*.......................................................................
        mul x12, x20, x16                            // ..................................................................................................*..................................................
        // gap                                       // .....................................................................................................................................................
        // gap                                       // .....................................................................................................................................................
        adc x5, x8, x7                               // ..............................................................................*......................................................................
        adds xzr, x19, #1                            // ....................................................................................*................................................................
        // gap                                       // .....................................................................................................................................................
        // gap                                       // .....................................................................................................................................................
        adcs x21, x9, x21                            // ......................................................................................*..............................................................
        eor x8, x25, x14                             // .................................................................................................*...................................................
        // gap                                       // .....................................................................................................................................................
        usra v0.2D, v25.2D, #32                      // .............................e.......................................................................................................................
        adcs x13, x17, x24                           // ........................................................................................*............................................................
        stp x29, x21, [x1, #0]                       // ..............................................................................................*......................................................
        umulh x20, x20, x16                          // ...................................................................................................*.................................................
        uaddlp v10.2D, v7.4S                         // .........e...........................................................................................................................................
        adcs x17, x10, x19                           // .........................................................................................*...........................................................
        // gap                                       // .....................................................................................................................................................
        // gap                                       // .....................................................................................................................................................
        mov x3, v2.d[1]                              // ................................e....................................................................................................................
        ldph x29, x24, sp, #cache_a03, t03           // .........................................................................................................................*...........................
        adcs x25, x6, x19                            // ..........................................................................................*..........................................................
        ldp x6, x21, [x30, #cache_m30 - 96]          // ..........................................................................................................................*..........................
        // gap                                       // .....................................................................................................................................................
        eor x10, x12, x8                             // .....................................................................................................*...............................................
        // gap                                       // .....................................................................................................................................................
        adcs x9, x4, x19                             // ...........................................................................................*.........................................................
        mov x26, v0.d[0]                             // ...............................e.....................................................................................................................
        ldp x4, x16, [x30, #cache_m21 - 96]          // .......................................................................................................................................*.............
        // gap                                       // .....................................................................................................................................................
        adcs x12, x23, x19                           // ............................................................................................*........................................................
        // gap                                       // .....................................................................................................................................................
        adc x5, x5, x19                              // .............................................................................................*.......................................................
        adds xzr, x8, #1                             // ....................................................................................................*................................................
        ldph x7, x19, sp, #cache_a12, t12            // ......................................................................................................................................*..............
        // gap                                       // .....................................................................................................................................................
        adcs x14, x25, x10                           // ......................................................................................................*..............................................
        mul x25, x29, x6                             // ............................................................................................................................*........................
        eor x20, x20, x8                             // .......................................................................................................*.............................................
        // gap                                       // .....................................................................................................................................................
        adcs x23, x9, x20                            // ........................................................................................................*............................................
        ldph x9, x20, sp, #cache_a02, t02            // ...........................................................................................................e.........................................
        // gap                                       // .....................................................................................................................................................
        // gap                                       // .....................................................................................................................................................
        eor x24, x24, x21                            // ...........................................................................................................................*.........................
        adcs x12, x12, x8                            // .........................................................................................................*...........................................
        // gap                                       // .....................................................................................................................................................
        // gap                                       // .....................................................................................................................................................
        adc x10, x5, x8                              // ..........................................................................................................*..........................................
        adds xzr, x11, #1                            // ................................................................................................................*....................................
        umulh x5, x29, x6                            // .............................................................................................................................*.......................
        shl v15.2D, v10.2D, #32                      // ............e........................................................................................................................................
        adcs x8, x13, x22                            // ..................................................................................................................*..................................
        eor x13, x25, x24                            // ...............................................................................................................................*.....................
        // gap                                       // .....................................................................................................................................................
        // gap                                       // .....................................................................................................................................................
        adcs x29, x17, x15                           // ....................................................................................................................*................................
        // gap                                       // .....................................................................................................................................................
        // gap                                       // .....................................................................................................................................................
        umlal v15.2D, v21.2S, v28.2S                 // ..............e......................................................................................................................................
        adcs x22, x14, x11                           // .....................................................................................................................*...............................
        // gap                                       // .....................................................................................................................................................
        // gap                                       // .....................................................................................................................................................
        mov x17, v16.d[0]                            // ...................................e.................................................................................................................
        adcs x21, x23, x11                           // ......................................................................................................................*..............................
        // gap                                       // .....................................................................................................................................................
        mul x23, x7, x4                              // .........................................................................................................................................*...........
        // gap                                       // .....................................................................................................................................................
        adcs x14, x12, x11                           // .......................................................................................................................*.............................
        eor x12, x19, x16                            // ........................................................................................................................................*............
        // gap                                       // .....................................................................................................................................................
        mov x16, v2.d[0]                             // ..............................e......................................................................................................................
        adc x15, x10, x11                            // ........................................................................................................................*............................
        adds xzr, x24, #1                            // ..............................................................................................................................*......................
        // gap                                       // .....................................................................................................................................................
        // gap                                       // .....................................................................................................................................................
        eor x19, x5, x24                             // .................................................................................................................................*...................
        adcs x11, x29, x13                           // ................................................................................................................................*....................
        umulh x29, x7, x4                            // ..........................................................................................................................................*..........
        // gap                                       // .....................................................................................................................................................
        adcs x13, x22, x19                           // ..................................................................................................................................*..................
        ldph x6, x5, sp, #cache_a01, t01             // ...............................................................................e.....................................................................
        ldp x7, x25, [x30, #cache_m20]               // ............................................................................................................e........................................
        // gap                                       // .....................................................................................................................................................
        adcs x19, x21, x24                           // ...................................................................................................................................*.................
        // gap                                       // .....................................................................................................................................................
        // gap                                       // .....................................................................................................................................................
        mov x21, v15.d[1]                            // ..................................e..................................................................................................................
        eor x22, x23, x12                            // ............................................................................................................................................*........
        adcs x14, x14, x24                           // ....................................................................................................................................*................
        // gap                                       // .....................................................................................................................................................
        mov x23, v16.d[1]                            // ....................................e................................................................................................................
        adc x15, x15, x24                            // .....................................................................................................................................*...............
        adds xzr, x12, #1                            // ...........................................................................................................................................*.........
        ldp x24, x10, [x30], #96                     // ................................................................................e....................................................................
        // gap                                       // .....................................................................................................................................................
        adcs x11, x11, x22                           // .............................................................................................................................................*.......
        mul x22, x9, x7                              // ..............................................................................................................e......................................
        eor x4, x29, x12                             // ...............................................................................................................................................*.....
        // gap                                       // .....................................................................................................................................................
        adcs x4, x13, x4                             // ................................................................................................................................................*....
        stp x8, x11, [x1, #16]                       // ..............................................................................................................................................*......
        // gap                                       // .....................................................................................................................................................
        // gap                                       // .....................................................................................................................................................
        adcs x13, x19, x12                           // .................................................................................................................................................*...
        // gap                                       // .....................................................................................................................................................
        // gap                                       // .....................................................................................................................................................
        // gap                                       // .....................................................................................................................................................
        eor x11, x20, x25                            // .............................................................................................................e.......................................
        ldp x20, x29, [x1, #32]!                     // ..........................................e..........................................................................................................
        adcs x14, x14, x12                           // ..................................................................................................................................................*..
        // gap                                       // .....................................................................................................................................................
        adc x15, x15, x12                            // ...................................................................................................................................................*.
        mov x12, x4                                  // ....................................................................................................................................................*
        umulh x8, x9, x7                             // ...............................................................................................................e.....................................

        // original source code
        // ldr q22, [x2, #32]!                         // e........................................................................................................................................................................................................................................................................................................ || e...........................................................................................................
        // ldr q23, [x2, #16]                          // .e....................................................................................................................................................................................................................................................................................................... || e...........................................................................................................
        // xtn     v4.2s, v22.2d                       // ............e............................................................................................................................................................................................................................................................................................ || ....e.......................................................................................................
        // umull   v6.2d, v4.2s, v28.2s                // ..........................e.............................................................................................................................................................................................................................................................................. || ........e...................................................................................................
        // umull   v7.2d, v4.2s, v30.2s                // ...................e..................................................................................................................................................................................................................................................................................... || ......e.....................................................................................................
        // uzp2    v16.4s, v22.4s, v22.4s              // ...........................e............................................................................................................................................................................................................................................................................. || ........e...................................................................................................
        // mul     v0.4s, v17.4s, v22.4s               // ........................................................................e................................................................................................................................................................................................................................ || ........................e...................................................................................
        // usra    v7.2d, v6.2d, #32                   // .......................................e................................................................................................................................................................................................................................................................. || ............e...............................................................................................
        // umull   v25.2d, v16.2s, v30.2s              // .........................................e............................................................................................................................................................................................................................................................... || .............e..............................................................................................
        // uaddlp  v0.2d, v0.4s                        // .....................................................................................e................................................................................................................................................................................................................... || .............................e..............................................................................
        // and     v2.16b, v7.16b, v29.16b             // ...............................................e......................................................................................................................................................................................................................................................... || ................e...........................................................................................
        // umlal   v2.2d, v16.2s, v28.2s               // .......................................................e................................................................................................................................................................................................................................................. || ...................e........................................................................................
        // shl     v24.2d, v0.2d, #32                  // .............................................................................................................e........................................................................................................................................................................................... || ......................................e.....................................................................
        // usra    v25.2d, v7.2d, #32                  // ...................................................e..................................................................................................................................................................................................................................................... || .................e..........................................................................................
        // umlal   v24.2d, v4.2s, v28.2s               // .................................................................................................................e....................................................................................................................................................................................... || ........................................e...................................................................
        // usra    v25.2d, v2.2d, #32                  // ....................................................................e.................................................................................................................................................................................................................................... || .......................e....................................................................................
        // xtn     v4.2s, v23.2d                       // .............e........................................................................................................................................................................................................................................................................................... || ....e.......................................................................................................
        // umull   v6.2d, v4.2s, v19.2s                // ..............................e.......................................................................................................................................................................................................................................................................... || .........e..................................................................................................
        // umull   v7.2d, v4.2s, v18.2s                // .......................e................................................................................................................................................................................................................................................................................. || .......e....................................................................................................
        // uzp2    v16.4s, v23.4s, v23.4s              // ...............e......................................................................................................................................................................................................................................................................................... || .....e......................................................................................................
        // mul     v0.4s, v20.4s, v23.4s               // ................................e........................................................................................................................................................................................................................................................................ || ..........e.................................................................................................
        // usra    v7.2d, v6.2d, #32                   // ...........................................e............................................................................................................................................................................................................................................................. || ..............e.............................................................................................
        // umull   v27.2d, v16.2s, v18.2s              // ......................................e.................................................................................................................................................................................................................................................................. || ............e...............................................................................................
        // uaddlp  v0.2d, v0.4s                        // .............................................e........................................................................................................................................................................................................................................................... || ...............e............................................................................................
        // and     v2.16b, v7.16b, v29.16b             // .....................................................e................................................................................................................................................................................................................................................... || ..................e.........................................................................................
        // umlal   v2.2d, v16.2s, v19.2s               // ..................................................................e...................................................................................................................................................................................................................................... || ......................e.....................................................................................
        // shl     v26.2d, v0.2d, #32                  // ..............................................................e.......................................................................................................................................................................................................................................... || .....................e......................................................................................
        // usra    v27.2d, v7.2d, #32                  // ..........................................................e.............................................................................................................................................................................................................................................. || ....................e.......................................................................................
        // umlal   v26.2d, v4.2s, v19.2s               // .....................................................................e................................................................................................................................................................................................................................... || .......................e....................................................................................
        // usra    v27.2d, v2.2d, #32                  // .................................................................................e....................................................................................................................................................................................................................... || ............................e...............................................................................
        // mov x16, v25.d[0]                           // ........................................................................................................................e................................................................................................................................................................................ || ...........................................e................................................................
        // mov x26, v27.d[0]                           // .............................................................................................e........................................................................................................................................................................................................... || ................................e...........................................................................
        // mov x3,  v25.d[1]                           // .......................................................................................e................................................................................................................................................................................................................. || ..............................e.............................................................................
        // mov x17, v27.d[1]                           // .........................................................................................................................................................*............................................................................................................................................... || .......................................................*....................................................
        // mov x20, v24.d[1]                           // ..................................................................................................................................e...................................................................................................................................................................... || ...............................................e............................................................
        // mov x21, v26.d[0]                           // ...................................................................................................................e..................................................................................................................................................................................... || .........................................e..................................................................
        // mov x24, v26.d[1]                           // .....................................................................................................................................e................................................................................................................................................................... || ................................................e...........................................................
        // adds x22, x20, x16                          // ........................................................................................................................................................*................................................................................................................................................ || ......................................................*.....................................................
        // adcs x23, x21, x3                           // ...........................................................................................................................................................*............................................................................................................................................. || .......................................................*....................................................
        // adcs x24, x24, x26                          // .............................................................................................................................................................*........................................................................................................................................... || ........................................................*...................................................
        // adc  x25, x17, xzr                          // ..............................................................................................................................................................*.......................................................................................................................................... || .........................................................*..................................................
        // mov  x17, v24.d[0]                          // .....................................................................................................................................................................*................................................................................................................................... || ...........................................................*................................................
        // ldp  x20, x21, [x1, #32]!                   // ................................................................................................................................................e........................................................................................................................................................ || ....................................................e.......................................................
        // adds x12, x12, x20                          // ...............................................................................................................................................................*......................................................................................................................................... || .........................................................*..................................................
        // adcs x13, x13, x21                          // ...................................................................................................................................................................*..................................................................................................................................... || ..........................................................*.................................................
        // ldp  x20, x21, [x1, #16]                    // ..........................................................................................................................................................*.............................................................................................................................................. || .......................................................*....................................................
        // adcs x14, x14, x20                          // ......................................................................................................................................................................*.................................................................................................................................. || ...........................................................*................................................
        // adcs x15, x15, x21                          // ..........................................................................................................................................................................*.............................................................................................................................. || ............................................................*...............................................
        // adc  x16, xzr, xzr                          // .............................................................................................................................................................................*........................................................................................................................... || .............................................................*..............................................
        // adds x19, x22, x17                          // ..............................................................................................................................................................................*.......................................................................................................................... || .............................................................*..............................................
        // adcs x22, x23, x22                          // ..................................................................................................................................................................................*...................................................................................................................... || ..............................................................*.............................................
        // adcs x23, x24, x23                          // ....................................................................................................................................................................................*.................................................................................................................... || ...............................................................*............................................
        // adcs x24, x25, x24                          // .......................................................................................................................................................................................*................................................................................................................. || ................................................................*...........................................
        // adc  x25, xzr, x25                          // .........................................................................................................................................................................................*............................................................................................................... || .................................................................*..........................................
        // adds x20, x22, x17                          // ..........................................................................................................................................................................................*.............................................................................................................. || .................................................................*..........................................
        // adcs x21, x23, x19                          // .............................................................................................................................................................................................*........................................................................................................... || ..................................................................*.........................................
        // adcs x22, x24, x22                          // ...............................................................................................................................................................................................*......................................................................................................... || ...................................................................*........................................
        // adcs x23, x25, x23                          // .................................................................................................................................................................................................*....................................................................................................... || ....................................................................*.......................................
        // adcs x24, xzr, x24                          // ...................................................................................................................................................................................................*..................................................................................................... || .....................................................................*......................................
        // adc  x25, xzr, x25                          // .....................................................................................................................................................................................................*................................................................................................... || ......................................................................*.....................................
        // adds x17, x17, x12                          // ......................................................................................................................................................................................................*.................................................................................................. || ......................................................................*.....................................
        // adcs x19, x19, x13                          // .........................................................................................................................................................................................................*............................................................................................... || .......................................................................*....................................
        // adcs x20, x20, x14                          // ...........................................................................................................................................................................................................*............................................................................................. || ........................................................................*...................................
        // adcs x21, x21, x15                          // ..............................................................................................................................................................................................................*.......................................................................................... || .........................................................................*..................................
        // adcs x22, x22, x16                          // ..................................................................................................................................................................................................................*...................................................................................... || ..........................................................................*.................................
        // adcs x23, x23, xzr                          // .....................................................................................................................................................................................................................*................................................................................... || ...........................................................................*................................
        // adcs x24, x24, xzr                          // ........................................................................................................................................................................................................................*................................................................................ || ............................................................................*...............................
        // adc x25, x25, xzr                           // ...........................................................................................................................................................................................................................*............................................................................. || .............................................................................*..............................
        // ldph x15, x12, sp, #cache_a23, t23          // .......................................................................................................................................................................*................................................................................................................................. || ...........................................................*................................................
        // ldp x13, x14, [x30, #cache_m32]             // ...........................................................................................................................................................................*............................................................................................................................. || ............................................................*...............................................
        // eor x12, x12, x14                           // ......................................................................................................................................................................................*.................................................................................................................. || ................................................................*...........................................
        // mul   x14, x15, x13                         // .......................................................................................................................................................................................................*................................................................................................. || ......................................................................*.....................................
        // umulh x13, x15, x13                         // .............................................................................................................................................................................................................*........................................................................................... || .........................................................................*..................................
        // adds  xzr, x12, #1                          // ............................................................................................................................................................................................................................*............................................................................ || .............................................................................*..............................
        // eor   x14, x14, x12                         // ................................................................................................................................................................................................................*........................................................................................ || ..........................................................................*.................................
        // adcs  x23, x23, x14                         // ..............................................................................................................................................................................................................................*.......................................................................... || ..............................................................................*.............................
        // eor   x13, x13, x12                         // ...............................................................................................................................................................................................................................*......................................................................... || ..............................................................................*.............................
        // adcs  x24, x24, x13                         // ................................................................................................................................................................................................................................*........................................................................ || ...............................................................................*............................
        // adc   x25, x25, x12                         // ..................................................................................................................................................................................................................................*...................................................................... || ................................................................................*...........................
        // ldph x15, x12, sp, #cache_a01, t01          // ...............................................................................................................................e......................................................................................................................................................................... || .............................................e..............................................................
        // ldp x13, x14, [x30], #96                    // ........................................................................................................................................e................................................................................................................................................................ || ................................................e...........................................................
        // eor x12, x12, x14                           // .......................................................................................................................................................*................................................................................................................................................. || ......................................................*.....................................................
        // mul   x14, x15, x13                         // ................................................................................................................................................................*........................................................................................................................................ || .........................................................*..................................................
        // umulh x13, x15, x13                         // .........................................................................................................................................................................*............................................................................................................................... || ............................................................*...............................................
        // adds  xzr, x12, #1                          // ...................................................................................................................................................................................................................................*..................................................................... || ................................................................................*...........................
        // eor   x14, x14, x12                         // ........................................................................................................................................................................................*................................................................................................................ || ................................................................*...........................................
        // adcs  x19, x19, x14                         // ....................................................................................................................................................................................................................................*.................................................................... || .................................................................................*..........................
        // eor   x13, x13, x12                         // ....................................................................................................................................................................................................................*.................................................................................... || ...........................................................................*................................
        // adcs  x20, x20, x13                         // .......................................................................................................................................................................................................................................*................................................................. || ..................................................................................*.........................
        // adcs  x21, x21, x12                         // ...........................................................................................................................................................................................................................................*............................................................. || ...................................................................................*........................
        // adcs  x22, x22, x12                         // ..............................................................................................................................................................................................................................................*.......................................................... || ....................................................................................*.......................
        // adcs  x23, x23, x12                         // .................................................................................................................................................................................................................................................*....................................................... || .....................................................................................*......................
        // adcs  x24, x24, x12                         // ....................................................................................................................................................................................................................................................*.................................................... || ......................................................................................*.....................
        // adc   x25, x25, x12                         // .....................................................................................................................................................................................................................................................*................................................... || .......................................................................................*....................
        // stp x17, x19, [x1, #0]                      // ........................................................................................................................................................................................................................................*................................................................ || ..................................................................................*.........................
        // ldph x15, x12, sp, #cache_a13, t13          // ......................................................................................................................................................................................................................*.................................................................................. || ...........................................................................*................................
        // ldp x13, x14, [x30, #(cache_m31 - 96)]      // .................................................................................................................................................................................................................*....................................................................................... || ..........................................................................*.................................
        // eor x12, x12, x14                           // .....................................................................................................................................................................................................................................*................................................................... || .................................................................................*..........................
        // mul   x14, x15, x13                         // .................................................................................................................................................................................................................................*....................................................................... || ...............................................................................*............................
        // umulh x13, x15, x13                         // .........................................................................................................................................................................................................................................*............................................................... || ..................................................................................*.........................
        // adds  xzr, x12, #1                          // ......................................................................................................................................................................................................................................................*.................................................. || .......................................................................................*....................
        // eor   x14, x14, x12                         // ................................................................................................................................................................................................................................................*........................................................ || .....................................................................................*......................
        // adcs  x22, x22, x14                         // ........................................................................................................................................................................................................................................................*................................................ || ........................................................................................*...................
        // eor   x13, x13, x12                         // ..........................................................................................................................................................................................................................................................*.............................................. || ........................................................................................*...................
        // adcs  x23, x23, x13                         // ...........................................................................................................................................................................................................................................................*............................................. || .........................................................................................*..................
        // adcs  x24, x24, x12                         // ..............................................................................................................................................................................................................................................................*.......................................... || ..........................................................................................*.................
        // adc   x25, x25, x12                         // ...............................................................................................................................................................................................................................................................*......................................... || ...........................................................................................*................
        // ldph x15, x12, sp, #cache_a02, t02          // .......................................................................................................e................................................................................................................................................................................................. || ...................................e........................................................................
        // ldp x13, x14, [x30, #(cache_m20 - 96)]      // ................................................................................................................................e........................................................................................................................................................................ || .............................................e..............................................................
        // eor x12, x12, x14                           // ...............................................................................................................................................e......................................................................................................................................................... || ....................................................e.......................................................
        // mul   x14, x15, x13                         // ..........................................................................................................................................e.............................................................................................................................................................. || .................................................e..........................................................
        // umulh x13, x15, x13                         // ....................................................................................................................................................e.................................................................................................................................................... || .....................................................e......................................................
        // adds  xzr, x12, #1                          // ................................................................................................................................................................................................................................................................*........................................ || ...........................................................................................*................
        // eor   x14, x14, x12                         // ............................................................................................................................................................*............................................................................................................................................ || ........................................................*...................................................
        // adcs  x20, x20, x14                         // ...................................................................................................................................................................................................................................................................*..................................... || ............................................................................................*...............
        // eor   x13, x13, x12                         // .................................................................................................................................................................................*....................................................................................................................... || ..............................................................*.............................................
        // adcs  x21, x21, x13                         // .....................................................................................................................................................................................................................................................................*................................... || .............................................................................................*..............
        // adcs  x22, x22, x12                         // .......................................................................................................................................................................................................................................................................*................................. || ..............................................................................................*.............
        // adcs  x23, x23, x12                         // .........................................................................................................................................................................................................................................................................*............................... || ...............................................................................................*............
        // adcs  x24, x24, x12                         // ...........................................................................................................................................................................................................................................................................*............................. || ................................................................................................*...........
        // adc   x25, x25, x12                         // ..............................................................................................................................................................................................................................................................................*.......................... || .................................................................................................*..........
        // ldph x15, x12, sp, #cache_a03, t03          // .............................................................................................................................................................................................................................................*........................................................... || ....................................................................................*.......................
        // ldp x13, x14, [x30, #(cache_m30 - 96)]      // ...............................................................................................................................................................................................................................................*......................................................... || ....................................................................................*.......................
        // eor x12, x12, x14                           // .............................................................................................................................................................................................................................................................*........................................... || ..........................................................................................*.................
        // mul   x14, x15, x13                         // .........................................................................................................................................................................................................................................................*............................................... || ........................................................................................*...................
        // umulh x13, x15, x13                         // .................................................................................................................................................................................................................................................................*....................................... || ...........................................................................................*................
        // adds  xzr, x12, #1                          // ...............................................................................................................................................................................................................................................................................*......................... || .................................................................................................*..........
        // eor   x14, x14, x12                         // ....................................................................................................................................................................................................................................................................*.................................... || ............................................................................................*...............
        // adcs  x21, x21, x14                         // .................................................................................................................................................................................................................................................................................*....................... || ..................................................................................................*.........
        // eor   x13, x13, x12                         // ................................................................................................................................................................................................................................................................................*........................ || ..................................................................................................*.........
        // adcs  x22, x22, x13                         // ...................................................................................................................................................................................................................................................................................*..................... || ...................................................................................................*........
        // adcs  x23, x23, x12                         // ......................................................................................................................................................................................................................................................................................*.................. || ....................................................................................................*.......
        // adcs  x24, x24, x12                         // .........................................................................................................................................................................................................................................................................................*............... || .....................................................................................................*......
        // adc   x25, x25, x12                         // ...........................................................................................................................................................................................................................................................................................*............. || ......................................................................................................*.....
        // ldph x15, x12, sp, #cache_a12, t12          // .......................................................................................................................................................................................................................................................*................................................. || .......................................................................................*....................
        // ldp x13, x14, [x30, #(cache_m21 - 96)]      // ...................................................................................................................................................................................................................................................*..................................................... || ......................................................................................*.....................
        // eor x12, x12, x14                           // ............................................................................................................................................................................................................................................................................*............................ || ................................................................................................*...........
        // mul   x14, x15, x13                         // ..........................................................................................................................................................................................................................................................................*.............................. || ...............................................................................................*............
        // umulh x13, x15, x13                         // ..................................................................................................................................................................................................................................................................................*...................... || ..................................................................................................*.........
        // adds  xzr, x12, #1                          // ............................................................................................................................................................................................................................................................................................*............ || ......................................................................................................*.....
        // eor   x14, x14, x12                         // ........................................................................................................................................................................................................................................................................................*................ || .....................................................................................................*......
        // adcs  x21, x21, x14                         // ..............................................................................................................................................................................................................................................................................................*.......... || .......................................................................................................*....
        // stp x20, x21, [x1, #16]                     // ..................................................................................................................................................................................................................................................................................................*...... || ........................................................................................................*...
        // eor x13, x13, x12                           // ................................................................................................................................................................................................................................................................................................*........ || .......................................................................................................*....
        // adcs x22, x22, x13                          // .................................................................................................................................................................................................................................................................................................*....... || ........................................................................................................*...
        // adcs x13, x23, x12                          // ...................................................................................................................................................................................................................................................................................................*..... || .........................................................................................................*..
        // adcs x14, x24, x12                          // ......................................................................................................................................................................................................................................................................................................*.. || ..........................................................................................................*.
        // adc x15, x25, x12                           // .......................................................................................................................................................................................................................................................................................................*. || ...........................................................................................................*
        // mov x12, x22                                // ........................................................................................................................................................................................................................................................................................................* || ...........................................................................................................*

        sub count, count, #1
        cbnz count, bignum_emontredc_8n_neon_maddloop_neon
        bignum_emontredc_8n_neon_inner_loop_postamble:
        umulh x19, x6, x24                           // ..............*...........................................................................................................
        ldph x7, x9, sp, #cache_a23, t23             // .............*............................................................................................................
        adds x4, x21, x16                            // .*........................................................................................................................
        mov x25, v0.d[1]                             // ..*.......................................................................................................................
        eor x5, x5, x10                              // *.........................................................................................................................
        adcs x17, x17, x3                            // ....*.....................................................................................................................
        ldp x16, x10, [x1, #16]                      // ...*......................................................................................................................                                            // gap(s) to follow
        adcs x21, x23, x26                           // ......*...................................................................................................................
        eor x8, x8, x11                              // ...................*......................................................................................................                                            // gap(s) to follow
        adc x23, x25, xzr                            // .......*..................................................................................................................
        adds x20, x12, x20                           // ........*.................................................................................................................                                            // gap(s) to follow
        adcs x12, x13, x29                           // ..........*...............................................................................................................                                            // gap(s) to follow
        mov x25, v15.d[0]                            // ...........*..............................................................................................................                                            // gap(s) to follow
        adcs x13, x14, x16                           // ............*.............................................................................................................
        eor x16, x19, x5                             // .........................................*................................................................................                                            // gap(s) to follow
        adcs x29, x15, x10                           // ...............*..........................................................................................................                                            // gap(s) to follow
        ldp x14, x19, [x30, #cache_m32 - 96]         // ................*.........................................................................................................                                            // gap(s) to follow
        mul x15, x6, x24                             // .........*................................................................................................................
        adc x24, xzr, xzr                            // .................*........................................................................................................
        adds x6, x4, x25                             // ..................*.......................................................................................................                                            // gap(s) to follow
        adcs x10, x17, x4                            // ....................*.....................................................................................................                                            // gap(s) to follow
        eor x4, x22, x11                             // .....*....................................................................................................................
        adcs x17, x21, x17                           // .....................*....................................................................................................                                            // gap(s) to follow
        eor x22, x9, x19                             // ......................*...................................................................................................                                            // gap(s) to follow
        adcs x9, x23, x21                            // .......................*..................................................................................................                                            // gap(s) to follow
        adc x21, xzr, x23                            // .........................*................................................................................................
        adds x23, x10, x25                           // ..........................*...............................................................................................                                            // gap(s) to follow
        eor x15, x15, x5                             // ........................*.................................................................................................
        adcs x19, x17, x6                            // ...........................*..............................................................................................                                            // gap(s) to follow
        ldp x26, xzr, [sp, #16]                      // ...........................................................................................................*..............
        sub x2, x2, x0                               // .....................................................................................................................*....
        adcs x10, x9, x10                            // ............................*.............................................................................................                                            // gap(s) to follow
        adcs x17, x21, x17                           // .............................*............................................................................................                                            // gap(s) to follow
        adcs x9, xzr, x9                             // ..............................*...........................................................................................                                            // gap(s) to follow
        adc x21, xzr, x21                            // ...............................*..........................................................................................
        adds x25, x25, x20                           // ................................*.........................................................................................
        mul x20, x7, x14                             // .................................*........................................................................................                                            // gap(s) to follow
        adcs x6, x6, x12                             // ..................................*.......................................................................................                                            // gap(s) to follow
        adcs x23, x23, x13                           // ...................................*......................................................................................                                            // gap(s) to follow
        adcs x13, x19, x29                           // .....................................*....................................................................................
        umulh x19, x7, x14                           // ....................................*.....................................................................................                                            // gap(s) to follow
        ldp x14, x29, [x30, #cache_m31 - 96]         // .......................................*..................................................................................
        adcs x10, x10, x24                           // ........................................*.................................................................................
        ldph x12, x7, sp, #cache_a13, t13            // ...........................................*..............................................................................                                            // gap(s) to follow
        adcs x17, x17, xzr                           // ..........................................*...............................................................................                                            // gap(s) to follow
        adcs x24, x9, xzr                            // ............................................*.............................................................................                                            // gap(s) to follow
        adc x9, x21, xzr                             // .............................................*............................................................................
        adds xzr, x22, #1                            // ..............................................*...........................................................................
        eor x21, x20, x22                            // ......................................*...................................................................................                                            // gap(s) to follow
        adcs x20, x17, x21                           // ...............................................*..........................................................................
        eor x17, x19, x22                            // ................................................*.........................................................................
        mul x19, x12, x14                            // ..................................................*.......................................................................                                            // gap(s) to follow
        eor x29, x7, x29                             // ......................................................*...................................................................                                            // gap(s) to follow
        adcs x17, x24, x17                           // .................................................*........................................................................                                            // gap(s) to follow
        adc x9, x9, x22                              // ...................................................*......................................................................
        adds xzr, x5, #1                             // ....................................................*.....................................................................                                            // gap(s) to follow
        umulh x21, x12, x14                          // .........................................................*................................................................
        ldph x14, x24, sp, #cache_a03, t03           // ...........................................................*..............................................................
        adcs x6, x6, x15                             // .....................................................*....................................................................                                            // gap(s) to follow
        adcs x7, x23, x16                            // .......................................................*..................................................................
        ldp x15, x12, [x30, #cache_m30 - 96]         // .............................................................*............................................................
        eor x19, x19, x29                            // ..............................................................*...........................................................                                            // gap(s) to follow
        adcs x13, x13, x5                            // ..........................................................*...............................................................
        stp x25, x6, [x1, #0]                        // ........................................................*.................................................................                                            // gap(s) to follow
        adcs x16, x10, x5                            // ............................................................*.............................................................                                            // gap(s) to follow
        ldp x10, x6, [x30, #cache_m21 - 96]          // ................................................................*.........................................................
        adcs x23, x20, x5                            // ...............................................................*..........................................................                                            // gap(s) to follow
        adcs x25, x17, x5                            // .................................................................*........................................................
        umulh x30, x14, x15                          // .............................................................................*............................................
        ldph x17, x22, sp, #cache_a12, t12           // ....................................................................*.....................................................                                            // gap(s) to follow
        adc x9, x9, x5                               // ..................................................................*.......................................................                                            // gap(s) to follow
        adds xzr, x29, #1                            // ...................................................................*......................................................                                            // gap(s) to follow
        eor x21, x21, x29                            // .......................................................................*..................................................
        adcs x16, x16, x19                           // .....................................................................*....................................................                                            // gap(s) to follow
        adcs x5, x23, x21                            // ........................................................................*.................................................                                            // gap(s) to follow
        eor x23, x24, x12                            // .........................................................................*................................................
        mul x12, x17, x10                            // ...................................................................................*......................................
        adcs x19, x25, x29                           // ..........................................................................*...............................................                                            // gap(s) to follow
        adc x29, x9, x29                             // ...........................................................................*..............................................
        adds xzr, x11, #1                            // ............................................................................*.............................................                                            // gap(s) to follow
        adcs x7, x7, x4                              // ..............................................................................*...........................................                                            // gap(s) to follow
        adcs x21, x13, x8                            // ................................................................................*.........................................
        mul x4, x14, x15                             // ......................................................................*...................................................                                            // gap(s) to follow
        eor x9, x30, x23                             // ........................................................................................*.................................                                            // gap(s) to follow
        adcs x30, x16, x11                           // .................................................................................*........................................                                            // gap(s) to follow
        adcs x24, x5, x11                            // ..................................................................................*.......................................                                            // gap(s) to follow
        adcs x16, x19, x11                           // ....................................................................................*.....................................                                            // gap(s) to follow
        adc x19, x29, x11                            // ......................................................................................*...................................
        adds xzr, x23, #1                            // .......................................................................................*..................................
        eor x8, x4, x23                              // ...............................................................................*..........................................                                            // gap(s) to follow
        adcs x4, x21, x8                             // .........................................................................................*................................
        umulh x21, x17, x10                          // ..........................................................................................*...............................                                            // gap(s) to follow
        adcs x8, x30, x9                             // ...........................................................................................*..............................                                            // gap(s) to follow
        ldp x10, x30, [x1, #32]                      // .........................................................................................................*................                                            // gap(s) to follow
        adcs x25, x24, x23                           // ............................................................................................*.............................
        eor x11, x22, x6                             // .....................................................................................*....................................                                            // gap(s) to follow
        adcs x22, x16, x23                           // ..............................................................................................*...........................                                            // gap(s) to follow
        eor x5, x12, x11                             // .............................................................................................*............................
        adc x29, x19, x23                            // ...............................................................................................*..........................
        adds xzr, x11, #1                            // ................................................................................................*.........................                                            // gap(s) to follow
        eor x14, x21, x11                            // ..................................................................................................*.......................
        adcs x9, x4, x5                              // .................................................................................................*........................                                            // gap(s) to follow
        stp x7, x9, [x1, #16]                        // ....................................................................................................*.....................
        adcs x9, x8, x14                             // ...................................................................................................*......................                                            // gap(s) to follow
        adcs x19, x25, x11                           // .....................................................................................................*....................
        ldp x8, x21, [x1, #48]                       // ..........................................................................................................*...............                                            // gap(s) to follow
        mov x24, x9                                  // ........................................................................................................*.................
        adcs x5, x22, x11                            // ......................................................................................................*...................                                            // gap(s) to follow
        adc x16, x29, x11                            // .......................................................................................................*..................
        adds xzr, x28, x28                           // ............................................................................................................*.............                                            // gap(s) to follow
        adcs x17, x10, x24                           // .............................................................................................................*............                                            // gap(s) to follow
        adcs x14, x30, x19                           // ..............................................................................................................*...........                                            // gap(s) to follow
        ldr x30, [sp, #8]                            // .........................................................................................................................*                                            // gap(s) to follow
        adcs x8, x8, x5                              // ...............................................................................................................*..........                                            // gap(s) to follow
        stp x17, x14, [x1, #32]                      // ..................................................................................................................*.......                                            // gap(s) to follow
        adcs x9, x21, x16                            // ................................................................................................................*.........                                            // gap(s) to follow
        csetm x28, cs                                // .................................................................................................................*........                                            // gap(s) to follow
        stp x8, x9, [x1, #48]                        // ...................................................................................................................*......                                            // gap(s) to follow
        subs x26, x26, #1                            // .......................................................................................................................*..
        sub x1, x1, x0                               // ....................................................................................................................*.....                                            // gap(s) to follow
        stp x26, xzr, [sp, #16]                      // ........................................................................................................................*.
        add x1, x1, #32                              // ......................................................................................................................*...                                            // gap(s) to follow

        // original source code
        // eor x19, x5, x10                          // ....*..................................................................................................................... || .*.............................
        // adds x25, x21, x16                        // ..*....................................................................................................................... || *..............................
        // mov x16, v0.d[1]                          // ...*...................................................................................................................... || *..............................
        // ldp x4, x7, [x1, #16]                     // ......*................................................................................................................... || .*.............................
        // adcs x21, x17, x3                         // .....*.................................................................................................................... || .*.............................
        // eor x22, x22, x11                         // .....................*.................................................................................................... || .....*.........................
        // adcs x23, x23, x26                        // .......*.................................................................................................................. || .*.............................
        // adc x17, x16, xzr                         // .........*................................................................................................................ || ..*............................
        // adds x16, x12, x20                        // ..........*............................................................................................................... || ..*............................
        // mul x5, x6, x24                           // .................*........................................................................................................ || ....*..........................
        // adcs x9, x13, x29                         // ...........*.............................................................................................................. || ..*............................
        // mov x29, v15.d[0]                         // ............*............................................................................................................. || ...*...........................
        // adcs x4, x14, x4                          // .............*............................................................................................................ || ...*...........................
        // ldph x10, x13, sp, #cache_a23, t23        // .*........................................................................................................................ || *..............................
        // umulh x20, x6, x24                        // *......................................................................................................................... || *..............................
        // adcs x24, x15, x7                         // ...............*.......................................................................................................... || ...*...........................
        // ldp x12, x7, [x30, #cache_m32 - 96]       // ................*......................................................................................................... || ....*..........................
        // adc x6, xzr, xzr                          // ..................*....................................................................................................... || ....*..........................
        // adds x14, x25, x29                        // ...................*...................................................................................................... || ....*..........................
        // eor x15, x8, x11                          // ........*................................................................................................................. || ..*............................
        // adcs x25, x21, x25                        // ....................*..................................................................................................... || .....*.........................
        // adcs x8, x23, x21                         // ......................*................................................................................................... || .....*.........................
        // eor x7, x13, x7                           // .......................*.................................................................................................. || .....*.........................
        // adcs x23, x17, x23                        // ........................*................................................................................................. || ......*........................
        // eor x21, x5, x19                          // ...........................*.............................................................................................. || ......*........................
        // adc x13, xzr, x17                         // .........................*................................................................................................ || ......*........................
        // adds x17, x25, x29                        // ..........................*............................................................................................... || ......*........................
        // adcs x5, x8, x14                          // ............................*............................................................................................. || .......*.......................
        // adcs x25, x23, x25                        // ...............................*.......................................................................................... || .......*.......................
        // adcs x8, x13, x8                          // ................................*......................................................................................... || ........*......................
        // adcs x23, xzr, x23                        // .................................*........................................................................................ || ........*......................
        // adc x13, xzr, x13                         // ..................................*....................................................................................... || ........*......................
        // adds x29, x29, x16                        // ...................................*...................................................................................... || ........*......................
        // mul x16, x10, x12                         // ....................................*..................................................................................... || .........*.....................
        // adcs x9, x14, x9                          // .....................................*.................................................................................... || .........*.....................
        // adcs x17, x17, x4                         // ......................................*................................................................................... || .........*.....................
        // umulh x12, x10, x12                       // ........................................*................................................................................. || ..........*....................
        // adcs x10, x5, x24                         // .......................................*.................................................................................. || .........*.....................
        // eor x5, x16, x7                           // ................................................*......................................................................... || ............*..................
        // ldp x16, x14, [x30, #cache_m31 - 96]      // .........................................*................................................................................ || ..........*....................
        // adcs x6, x25, x6                          // ..........................................*............................................................................... || ..........*....................
        // eor x24, x20, x19                         // ..............*........................................................................................................... || ...*...........................
        // adcs x4, x8, xzr                          // ............................................*............................................................................. || ...........*...................
        // ldph x20, x25, sp, #cache_a13, t13        // ...........................................*.............................................................................. || ..........*....................
        // adcs x23, x23, xzr                        // .............................................*............................................................................ || ...........*...................
        // adc x8, x13, xzr                          // ..............................................*........................................................................... || ...........*...................
        // adds xzr, x7, #1                          // ...............................................*.......................................................................... || ...........*...................
        // adcs x4, x4, x5                           // .................................................*........................................................................ || ............*..................
        // eor x5, x12, x7                           // ..................................................*....................................................................... || ............*..................
        // adcs x23, x23, x5                         // .....................................................*.................................................................... || .............*.................
        // mul x12, x20, x16                         // ...................................................*...................................................................... || ............*..................
        // adc x5, x8, x7                            // ......................................................*................................................................... || .............*.................
        // adds xzr, x19, #1                         // .......................................................*.................................................................. || .............*.................
        // adcs x21, x9, x21                         // ..........................................................*............................................................... || ..............*................
        // eor x8, x25, x14                          // ....................................................*..................................................................... || .............*.................
        // adcs x13, x17, x24                        // ...........................................................*.............................................................. || ..............*................
        // stp x29, x21, [x1, #0]                    // ...............................................................*.......................................................... || ...............*...............
        // umulh x20, x20, x16                       // ........................................................*................................................................. || ..............*................
        // adcs x17, x10, x19                        // ..............................................................*........................................................... || ...............*...............
        // ldph x29, x24, sp, #cache_a03, t03        // .........................................................*................................................................ || ..............*................
        // adcs x25, x6, x19                         // ................................................................*......................................................... || ................*..............
        // ldp x6, x21, [x30, #cache_m30 - 96]       // ............................................................*............................................................. || ...............*...............
        // eor x10, x12, x8                          // .............................................................*............................................................ || ...............*...............
        // adcs x9, x4, x19                          // ..................................................................*....................................................... || ................*..............
        // ldp x4, x16, [x30, #cache_m21 - 96]       // .................................................................*........................................................ || ................*..............
        // adcs x12, x23, x19                        // ...................................................................*...................................................... || ................*..............
        // adc x5, x5, x19                           // ......................................................................*................................................... || .................*.............
        // adds xzr, x8, #1                          // .......................................................................*.................................................. || .................*.............
        // ldph x7, x19, sp, #cache_a12, t12         // .....................................................................*.................................................... || .................*.............
        // adcs x14, x25, x10                        // .........................................................................*................................................ || ..................*............
        // mul x25, x29, x6                          // ..................................................................................*....................................... || ....................*..........
        // eor x20, x20, x8                          // ........................................................................*................................................. || ..................*............
        // adcs x23, x9, x20                         // ..........................................................................*............................................... || ..................*............
        // eor x24, x24, x21                         // ...........................................................................*.............................................. || ..................*............
        // adcs x12, x12, x8                         // .............................................................................*............................................ || ...................*...........
        // adc x10, x5, x8                           // ..............................................................................*........................................... || ...................*...........
        // adds xzr, x11, #1                         // ...............................................................................*.......................................... || ...................*...........
        // umulh x5, x29, x6                         // ....................................................................*..................................................... || .................*.............
        // adcs x8, x13, x22                         // ................................................................................*......................................... || ....................*..........
        // eor x13, x25, x24                         // .........................................................................................*................................ || ......................*........
        // adcs x29, x17, x15                        // .................................................................................*........................................ || ....................*..........
        // adcs x22, x14, x11                        // ....................................................................................*..................................... || .....................*.........
        // adcs x21, x23, x11                        // .....................................................................................*.................................... || .....................*.........
        // mul x23, x7, x4                           // ............................................................................*............................................. || ...................*...........
        // adcs x14, x12, x11                        // ......................................................................................*................................... || .....................*.........
        // eor x12, x19, x16                         // ...............................................................................................*.......................... || .......................*.......
        // adc x15, x10, x11                         // .......................................................................................*.................................. || .....................*.........
        // adds xzr, x24, #1                         // ........................................................................................*................................. || ......................*........
        // eor x19, x5, x24                          // ...................................................................................*...................................... || ....................*..........
        // adcs x11, x29, x13                        // ..........................................................................................*............................... || ......................*........
        // umulh x29, x7, x4                         // ...........................................................................................*.............................. || ......................*........
        // adcs x13, x22, x19                        // ............................................................................................*............................. || .......................*.......
        // adcs x19, x21, x24                        // ..............................................................................................*........................... || .......................*.......
        // eor x22, x23, x12                         // .................................................................................................*........................ || ........................*......
        // adcs x14, x14, x24                        // ................................................................................................*......................... || ........................*......
        // adc x15, x15, x24                         // ..................................................................................................*....................... || ........................*......
        // adds xzr, x12, #1                         // ...................................................................................................*...................... || ........................*......
        // adcs x11, x11, x22                        // .....................................................................................................*.................... || .........................*.....
        // eor x4, x29, x12                          // ....................................................................................................*..................... || .........................*.....
        // adcs x4, x13, x4                          // .......................................................................................................*.................. || .........................*.....
        // stp x8, x11, [x1, #16]                    // ......................................................................................................*................... || .........................*.....
        // adcs x13, x19, x12                        // ........................................................................................................*................. || ..........................*....
        // adcs x14, x14, x12                        // ...........................................................................................................*.............. || ..........................*....
        // adc x15, x15, x12                         // ............................................................................................................*............. || ...........................*...
        // mov x12, x4                               // ..........................................................................................................*............... || ..........................*....
        // ldp x17, x19, [x1, #32]                   // .............................................................................................*............................ || .......................*.......
        // ldp x20, x21, [x1, #48]                   // .........................................................................................................*................ || ..........................*....
        // ldp x26, xzr, [sp, #16]                   // .............................*............................................................................................ || .......*.......................
        // adds xzr, x28, x28                        // .............................................................................................................*............ || ...........................*...
        // adcs x17, x17, x12                        // ..............................................................................................................*........... || ...........................*...
        // adcs x19, x19, x13                        // ...............................................................................................................*.......... || ...........................*...
        // adcs x20, x20, x14                        // .................................................................................................................*........ || ............................*..
        // adcs x21, x21, x15                        // ...................................................................................................................*...... || ............................*..
        // csetm x28, cs                             // ....................................................................................................................*..... || .............................*.
        // stp x17, x19, [x1, #32]                   // ..................................................................................................................*....... || ............................*..
        // stp x20, x21, [x1, #48]                   // .....................................................................................................................*.... || .............................*.
        // sub x1, x1, x0                            // .......................................................................................................................*.. || .............................*.
        // sub x2, x2, x0                            // ..............................*........................................................................................... || .......*.......................
        // add x1, x1, #32                           // .........................................................................................................................* || ..............................*
        // subs x26, x26, #1                         // ......................................................................................................................*... || .............................*.
        // stp x26, xzr, [sp, #16]                   // ........................................................................................................................*. || ..............................*
        // ldr x30, [sp, #8]                         // ................................................................................................................*......... || ............................*..

        bignum_emontredc_8n_neon_outer_loop_end:


          bne bignum_emontredc_8n_neon_outerloop
          neg x0, x28

bignum_emontredc_8n_neon_end:
           add sp, sp, #32
           add sp, sp, #(6*16)

           restore_vregs

           ldp x29, x30, [sp, #(0*16)]
           ldp x27, x28, [sp, #(1*16)]
           ldp x25, x26, [sp, #(2*16)]
           ldp x23, x24, [sp, #(3*16)]
           ldp x21, x22, [sp, #(4*16)]
           ldp x19, x20, [sp, #(5*16)]
           add sp, sp, #(6*16)

           ret
